local MarketplaceService = game:GetService("MarketplaceService")
local UserInputService = game:GetService("UserInputService")
local TweenService = game:GetService("TweenService")
local HttpService = game:GetService("HttpService")
local RunService = game:GetService("RunService")
local CoreGui = game:GetService("CoreGui")
local Players = game:GetService("Players")
local Player = Players.LocalPlayer
local PlayerMouse = Player:GetMouse()

local redzlib = {
	Themes = {
		Darker = {
			["Color Hub 1"] = ColorSequence.new({
				ColorSequenceKeypoint.new(0.00, Color3.fromRGB(25, 25, 25)),
				ColorSequenceKeypoint.new(0.50, Color3.fromRGB(32.5, 32.5, 32.5)),
				ColorSequenceKeypoint.new(1.00, Color3.fromRGB(25, 25, 25))
			}),
			["Color Hub 2"] = Color3.fromRGB(30, 30, 30),
			["Color Stroke"] = Color3.fromRGB(40, 40, 40),
			["Color Theme"] = Color3.fromRGB(88, 101, 242),
			["Color Text"] = Color3.fromRGB(243, 243, 243),
			["Color Dark Text"] = Color3.fromRGB(180, 180, 180)
		},
		Dark = {
			["Color Hub 1"] = ColorSequence.new({
				ColorSequenceKeypoint.new(0.00, Color3.fromRGB(40, 40, 40)),
				ColorSequenceKeypoint.new(0.50, Color3.fromRGB(47.5, 47.5, 47.5)),
				ColorSequenceKeypoint.new(1.00, Color3.fromRGB(40, 40, 40))
			}),
			["Color Hub 2"] = Color3.fromRGB(45, 45, 45),
			
			["Color Stroke"] = Color3.fromRGB(65, 65, 65),
			["Color Theme"] = Color3.fromRGB(65, 150, 255),
			["Color Text"] = Color3.fromRGB(245, 245, 245),
			["Color Dark Text"] = Color3.fromRGB(190, 190, 190)
		},
		Red = {
			["Color Hub 1"] = ColorSequence.new({
				ColorSequenceKeypoint.new(0.00, Color3.fromRGB(27.5, 25, 30)),
				ColorSequenceKeypoint.new(0.50, Color3.fromRGB(32.5, 32.5, 32.5)),
				ColorSequenceKeypoint.new(1.00, Color3.fromRGB(27.5, 25, 30))
			}),
			["Color Hub 2"] = Color3.fromRGB(30, 30, 30),
			["Color Stroke"] = Color3.fromRGB(40, 40, 40),
			["Color Theme"] = Color3.fromRGB(255, 0, 0),
			["Color Text"] = Color3.fromRGB(240, 240, 240),
			["Color Dark Text"] = Color3.fromRGB(180, 180, 180),
			["Color Dark Purple"] = Color3.fromRGB(255, 0, 0),
			["Color Hub 9"] = Color3.fromRGB(0, 0, 0, 0),
			["Color Dark Greem"] = Color3.fromRGB(43, 255, 0)
		}
	},
	Info = {
		Version = "1.2.0"
	},
	Save = {
		UISize = {550, 380},
		TabSize = 160,
		Theme = "Red"
	},
	Settings = {},
	Connection = {},
	Instances = {},
	Elements = {},
	Options = {},
	Flags = {},
	Tabs = {},
	Icons = (function()
		return {
			["anchor"] = "rbxassetid://10709761530",
			["apple"] = "rbxassetid://10709761889",
			["car"] = "rbxassetid://10709789810",
			["carrot"] = "rbxassetid://10709789960",
			["usercog"] = "rbxassetid://10747372167",
			["userminus"] = "rbxassetid://10747372346",
			["userplus"] = "rbxassetid://10747372702",
			["userx"] = "rbxassetid://10747372992",
			["info"] = "rbxassetid://10723415903",
			["eye"] = "rbxassetid://10723346959",
    	    ["home"] = "rbxassetid://10723407389",
    	    ["truck"] = "rbxassetid://10747364031",
			["headphones"] = "rbxassetid://10723406165",
			["Drip"] = "rbxassetid://72495850369898",
			["flame"] = "rbxassetid://10723376114",
			["shirt"] = "rbxassetid://10734952036",
			["settings"] = "rbxassetid://10734950309",
			["shield"] = "rbxassetid://10734951847",
			["coffee"] = "rbxassetid://10709810814",
			["users"] = "rbxassetid //10747373426",
            ["baby"] = "rbxassetid://10709769732",
			["ghost"] = "rbxassetid://10723396107",
			
		}
	end)()
}

local ViewportSize = workspace.CurrentCamera.ViewportSize
local UIScale = ViewportSize.Y / 450

local Settings = redzlib.Settings
local Flags = redzlib.Flags

local SetProps, SetChildren, InsertTheme, Create do
	InsertTheme = function(Instance, Type)
		table.insert(redzlib.Instances, {
			Instance = Instance,
			Type = Type
		})
		return Instance
	end
	
	SetChildren = function(Instance, Children)
		if Children then
			table.foreach(Children, function(_,Child)
				Child.Parent = Instance
			end)
		end
		return Instance
	end
	
	SetProps = function(Instance, Props)
		if Props then
			table.foreach(Props, function(prop, value)
				Instance[prop] = value
			end)
		end
		return Instance
	end
	
	Create = function(...)
		local args = {...}
		if type(args) ~= "table" then return end
		local new = Instance.new(args[1])
		local Children = {}
		
		if type(args[2]) == "table" then
			SetProps(new, args[2])
			SetChildren(new, args[3])
			Children = args[3] or {}
		elseif typeof(args[2]) == "Instance" then
			new.Parent = args[2]
			SetProps(new, args[3])
			SetChildren(new, args[4])
			Children = args[4] or {}
		end
		return new
	end
	
	local function Save(file)
		if readfile and isfile and isfile(file) then
			local decode = HttpService:JSONDecode(readfile(file))
			
			if type(decode) == "table" then
				if rawget(decode, "UISize") then redzlib.Save["UISize"] = decode["UISize"] end
				if rawget(decode, "TabSize") then redzlib.Save["TabSize"] = decode["TabSize"] end
				if rawget(decode, "Theme") and VerifyTheme(decode["Theme"]) then redzlib.Save["Theme"] = decode["Theme"] end
			end
		end
	end
	
	pcall(Save, "redz library V5.json")
end

local Funcs = {} do
	function Funcs:InsertCallback(tab, func)
		if type(func) == "function" then
			table.insert(tab, func)
		end
		return func
	end
	
	function Funcs:FireCallback(tab, ...)
		for _,v in ipairs(tab) do
			if type(v) == "function" then
				task.spawn(v, ...)
			end
		end
	end
	
	function Funcs:ToggleVisible(Obj, Bool)
		Obj.Visible = Bool ~= nil and Bool or Obj.Visible
	end
	
	function Funcs:ToggleParent(Obj, Parent)
		if Bool ~= nil then
			Obj.Parent = Bool
		else
			Obj.Parent = not Obj.Parent and Parent
		end
	end
	
	function Funcs:GetConnectionFunctions(ConnectedFuncs, func)
		local Connected = { Function = func, Connected = true }
		
		function Connected:Disconnect()
			if self.Connected then
				table.remove(ConnectedFuncs, table.find(ConnectedFuncs, self.Function))
				self.Connected = false
			end
		end
		
		function Connected:Fire(...)
			if self.Connected then
				task.spawn(self.Function, ...)
			end
		end
		
		return Connected
	end
	
	function Funcs:GetCallback(Configs, index)
		local func = Configs[index] or Configs.Callback or function()end
		
		if type(func) == "table" then
			return ({function(Value) func[1][func[2]] = Value end})
		end
		return {func}
	end
end

local Connections, Connection = {}, redzlib.Connection do
	local function NewConnectionList(List)
		if type(List) ~= "table" then return end
		
		for _,CoName in ipairs(List) do
			local ConnectedFuncs, Connect = {}, {}
			Connection[CoName] = Connect
			Connections[CoName] = ConnectedFuncs
			Connect.Name = CoName
			
			function Connect:Connect(func)
				if type(func) == "function" then
					table.insert(ConnectedFuncs, func)
					return Funcs:GetConnectionFunctions(ConnectedFuncs, func)
				end
			end
			
			-- LINHA REMOVIDA: NotificationContainer foi movido para depois da criação do ScreenGui
			
			function Connect:Once(func)
				if type(func) == "function" then
					local Connected;
					
					local _NFunc;_NFunc = function(...)
						task.spawn(func, ...)
						Connected:Disconnect()
					end
					
					Connected = Funcs:GetConnectionFunctions(ConnectedFuncs, _NFunc)
					return Connected
				end
			end
		end
	end
	

	function Connection:FireConnection(CoName, ...)
		local Connection = type(CoName) == "string" and Connections[CoName] or Connections[CoName.Name]
		for _,Func in pairs(Connection) do
			task.spawn(Func, ...)
		end
	end
	
	NewConnectionList({"FlagsChanged", "ThemeChanged", "FileSaved", "ThemeChanging", "OptionAdded"})
end

local GetFlag, SetFlag, CheckFlag do
	CheckFlag = function(Name)
		return type(Name) == "string" and Flags[Name] ~= nil
	end
	
	GetFlag = function(Name)
		return type(Name) == "string" and Flags[Name]
	end
	
	SetFlag = function(Flag, Value)
		if Flag and (Value ~= Flags[Flag] or type(Value) == "table") then
			Flags[Flag] = Value
			Connection:FireConnection("FlagsChanged", Flag, Value)
		end
	end
	
	local db
	Connection.FlagsChanged:Connect(function(Flag, Value)
		local ScriptFile = Settings.ScriptFile
		if not db and ScriptFile and writefile then
			db=true;task.wait(0.1);db=false
			
			local Success, Encoded = pcall(function()
				-- local _Flags = {}
				-- for _,Flag in pairs(Flags) do _Flags[_] = Flag.Value end
				return HttpService:JSONEncode(Flags)
			end)
			
			if Success then
				local Success = pcall(writefile, ScriptFile, Encoded)
				if Success then
					Connection:FireConnection("FileSaved", "Script-Flags", ScriptFile, Encoded)
				end
			end
		end
	end)
end

local ScreenGui = Create("ScreenGui", CoreGui, {
	Name = "redz Library V5",
}, {
	Create("UIScale", {
		Scale = UIScale,
		Name = "Scale"
	})
})

local ScreenFind = CoreGui:FindFirstChild(ScreenGui.Name)
if ScreenFind and ScreenFind ~= ScreenGui then
	ScreenFind:Destroy()
end

-- ========== NOTIFICATION CONTAINER MOVED HERE ==========
local NotificationContainer = Create("Frame", ScreenGui, {
	Name = "NotificationContainer",
	Size = UDim2.new(0, 280, 1, 0),
	Position = UDim2.new(1, -300, 1, -20),
	AnchorPoint = Vector2.new(0, 1),
	BackgroundTransparency = 1,
	ZIndex = 999
}, {
	Create("UIListLayout", {
		SortOrder = "LayoutOrder",
		Padding = UDim.new(0, 8),
		VerticalAlignment = "Bottom"
	})
})
-- =======================================================

local function GetStr(val)
	if type(val) == "function" then
		return val()
	end
	return val
end

local function ConnectSave(Instance, func)
	Instance.InputBegan:Connect(function(Input)
		if Input.UserInputType == Enum.UserInputType.MouseButton1 or Input.UserInputType == Enum.UserInputType.Touch then
			while UserInputService:IsMouseButtonPressed(Enum.UserInputType.MouseButton1) do task.wait()
			end
		end
		func()
	end)
end

local function CreateTween(Configs)
	local Instance = Configs[1] or Configs.Instance
	local Prop = Configs[2] or Configs.Prop
	local NewVal = Configs[3] or Configs.NewVal
	local Time = Configs[4] or Configs.Time or 0.5
	local TweenWait = Configs[5] or Configs.wait or false
	local TweenInfo = TweenInfo.new(Time, Enum.EasingStyle.Quint)
	
	local Tween = TweenService:Create(Instance, TweenInfo, {[Prop] = NewVal})
	Tween:Play()
	if TweenWait then
		Tween.Completed:Wait()
	end
	return Tween
end

local function MakeDrag(Instance)
	task.spawn(function()
		SetProps(Instance, {
			Active = true,
			AutoButtonColor = false
		})
		
		local DragStart, StartPos, InputOn
		
		local function Update(Input)
			local delta = Input.Position - DragStart
			local Position = UDim2.new(StartPos.X.Scale, StartPos.X.Offset + delta.X / UIScale, StartPos.Y.Scale, StartPos.Y.Offset + delta.Y / UIScale)
			-- Instance.Position = Position
			CreateTween({Instance, "Position", Position, 0.35})
		end
		
		Instance.MouseButton1Down:Connect(function()
			InputOn = true
		end)
		
		Instance.InputBegan:Connect(function(Input)
			if Input.UserInputType == Enum.UserInputType.MouseButton1 or Input.UserInputType == Enum.UserInputType.Touch then
				StartPos = Instance.Position
				DragStart = Input.Position
				
				while UserInputService:IsMouseButtonPressed(Enum.UserInputType.MouseButton1) do RunService.Heartbeat:Wait()
					if InputOn then
						Update(Input)
					end
				end
				InputOn = false
			end
		end)
	end)
	return Instance
end

local function VerifyTheme(Theme)
	for name,_ in pairs(redzlib.Themes) do
		if name == Theme then
			return true
		end
	end
end

local function SaveJson(FileName, save)
	if writefile then
		local json = HttpService:JSONEncode(save)
		writefile(FileName, json)
	end
end

local Theme = redzlib.Themes[redzlib.Save.Theme]

local function AddEle(Name, Func)
	redzlib.Elements[Name] = Func
end

local function Make(Ele, Instance, props, ...)
	local Element = redzlib.Elements[Ele](Instance, props, ...)
	return Element
end

AddEle("Corner", function(parent, CornerRadius)
	local New = SetProps(Create("UICorner", parent, {
		CornerRadius = CornerRadius or UDim.new(0, 7)
	}), props)
	return New
end)

AddEle("Stroke", function(parent, props, ...)
	local args = {...}
	local New = InsertTheme(SetProps(Create("UIStroke", parent, {
		Color = args[1] or Theme["Color Stroke"],
		Thickness = args[2] or 1,
		ApplyStrokeMode = "Border"
	}), props), "Stroke")
	return New
end)

AddEle("Button", function(parent, props, ...)
	local args = {...}
	local New = InsertTheme(SetProps(Create("TextButton", parent, {
		Text = "",
		Size = UDim2.fromScale(1, 1),
		BackgroundColor3 = Theme["Color Hub 2"],
		AutoButtonColor = false
	}), props), "Frame")

	local OriginalSize = New.Size
	local IsMouseOver = false

	New.MouseEnter:Connect(function()
		IsMouseOver = true
		New.BackgroundTransparency = 0.4
	end)
	
	New.MouseLeave:Connect(function()
		IsMouseOver = false
		New.BackgroundTransparency = 0
	end)

	New.MouseButton1Down:Connect(function()
		CreateTween({New, "Size", OriginalSize - UDim2.fromOffset(4, 2), 0.1})
		CreateTween({New, "BackgroundTransparency", 0.6, 0.1})
	end)

	New.MouseButton1Up:Connect(function()
		CreateTween({New, "Size", OriginalSize, 0.15})
		CreateTween({New, "BackgroundTransparency", IsMouseOver and 0.4 or 0, 0.15})
	end)

	if args[1] then
		New.Activated:Connect(args[1])
	end

	return New
end)
AddEle("Gradient", function(parent, props, ...)
	local args = {...}
	local New = InsertTheme(SetProps(Create("UIGradient", parent, {
		Color = Theme["Color Hub 1"]
	}), props), "Gradient")
	return New
end)

local function ButtonFrame(Instance, Title, Description, HolderSize)
	local TitleL = InsertTheme(Create("TextLabel", {
		Font = Enum.Font.FredokaOne, --GothamMedium
		TextColor3 = Theme["Color Text"],
		Size = UDim2.new(1, -20),
		AutomaticSize = "Y",
		Position = UDim2.new(0, 0, 0.5),
		AnchorPoint = Vector2.new(0, 0.5),
		BackgroundTransparency = 1,
		TextTruncate = "AtEnd",
		TextSize = 10,
		TextXAlignment = "Left",
		Text = "",
		RichText = true
	}), "Text")
	
	local DescL = InsertTheme(Create("TextLabel", {
		Font = Enum.Font.Gotham,
		TextColor3 = Theme["Color Dark Text"],
		Size = UDim2.new(1, -20),
		AutomaticSize = "Y",
		Position = UDim2.new(0, 12, 0, 15),
		BackgroundTransparency = 1,
		TextWrapped = true,
		TextSize = 8,
		TextXAlignment = "Left",
		Text = "",
		RichText = true
	}), "DarkText")

	local Frame = Make("Button", Instance, {
		Size = UDim2.new(1, 0, 0, 25),
		AutomaticSize = "Y",
		Name = "Option"
	})Make("Corner", Frame, UDim.new(0, 6))
	
	LabelHolder = Create("Frame", Frame, {
		AutomaticSize = "Y",
		BackgroundTransparency = 1,
		Size = HolderSize,
		Position = UDim2.new(0, 10, 0),
		AnchorPoint = Vector2.new(0, 0)
	}, {
		Create("UIListLayout", {
			SortOrder = "LayoutOrder",
			VerticalAlignment = "Center",
			Padding = UDim.new(0, 2)
		}),
		Create("UIPadding", {
			PaddingBottom = UDim.new(0, 5),
			PaddingTop = UDim.new(0, 5)
		}),
		TitleL,
		DescL,
	})
	
	local Label = {}
	function Label:SetTitle(NewTitle)
		if type(NewTitle) == "string" and NewTitle:gsub(" ", ""):len() > 0 then
			TitleL.Text = NewTitle
		end
	end
	function Label:SetDesc(NewDesc)
		if type(NewDesc) == "string" and NewDesc:gsub(" ", ""):len() > 0 then
			DescL.Visible = true
			DescL.Text = NewDesc
			LabelHolder.Position = UDim2.new(0, 10, 0)
			LabelHolder.AnchorPoint = Vector2.new(0, 0)
		else
			DescL.Visible = false
			DescL.Text = ""
			LabelHolder.Position = UDim2.new(0, 10, 0.5)
			LabelHolder.AnchorPoint = Vector2.new(0, 0.5)
		end
	end
	
	Label:SetTitle(Title)
	Label:SetDesc(Description)
	return Frame, Label
end

local function GetColor(Instance)
	if Instance:IsA("Frame") then
		return "BackgroundColor3"
	elseif Instance:IsA("ImageLabel") then
		return "ImageColor3"
	elseif Instance:IsA("TextLabel") then
		return "TextColor3"
	elseif Instance:IsA("ScrollingFrame") then
		return "ScrollBarImageColor3"
	elseif Instance:IsA("UIStroke") then
		return "Color"
	end
	return ""
end

-- /////////// --
function redzlib:GetIcon(index)
	if type(index) ~= "string" or index:find("rbxassetid://") or #index == 0 then
		return index
	end
	
	local firstMatch = nil
	index = string.lower(index):gsub("lucide", ""):gsub("-", "")
	
	for Name, Icon in self.Icons do
		Name = Name:gsub("lucide", ""):gsub("-", "")
		if Name == index then
			return Icon
		elseif not firstMatch and Name:find(index, 1, true) then
			firstMatch = Icon
		end
	end
	
	return firstMatch or index
end

function redzlib:SetTheme(NewTheme)
	if not VerifyTheme(NewTheme) then return end
	
	redzlib.Save.Theme = NewTheme
	SaveJson("redz library V5.json", redzlib.Save)
	Theme = redzlib.Themes[NewTheme]
	
	Comnection:FireConnection("ThemeChanged", NewTheme)
	table.foreach(redzlib.Instances, function(_,Val)
		if Val.Type == "Gradient" then
			Val.Instance.Color = Theme["Color Hub 1"]
		elseif Val.Type == "Frame" then
			Val.Instance.BackgroundColor3 = Theme["Color Hub 2"]
		elseif Val.Type == "Stroke" then
			Val.Instance[GetColor(Val.Instance)] = Theme["Color Stroke"]
		elseif Val.Type == "Theme" then
			Val.Instance[GetColor(Val.Instance)] = Theme["Color Theme"]
		elseif Val.Type == "Text" then
			Val.Instance[GetColor(Val.Instance)] = Theme["Color Text"]
		elseif Val.Type == "DarkText" then
			Val.Instance[GetColor(Val.Instance)] = Theme["Color Dark Text"]
		elseif Val.Type == "ScrollBar" then
			Val.Instance[GetColor(Val.Instance)] = Theme["Color Theme"]
		end
	end)
end

function redzlib:SetScale(NewScale)
	NewScale = ViewportSize.Y / math.clamp(NewScale, 300, 2000)
	UIScale, ScreenGui.Scale.Scale = NewScale, NewScale
end

local NotificationContainer = Create("Frame", ScreenGui, {
	Name = "NotificationContainer",
	Size = UDim2.new(0, 280, 1, 0),
	Position = UDim2.new(1, -300, 1, -20),
	AnchorPoint = Vector2.new(0, 1),
	BackgroundTransparency = 1,
	ZIndex = 999
}, {
	Create("UIListLayout", {
		SortOrder = "LayoutOrder",
		Padding = UDim.new(0, 8),
		VerticalAlignment = "Bottom"
	})
})

function redzlib:Notify(Configs)
	local Title = Configs[1] or Configs.Title or "Notification"
	local Description = Configs[2] or Configs.Description or Configs.Text or ""
	local Duration = Configs[3] or Configs.Duration or 5
	local Type = Configs.Type or "Info"
	local Image = Configs.Image or "rbxassetid://113449060491896"
	
	local Colors = {
		Info = Color3.fromRGB(88, 101, 242),
		Success = Color3.fromRGB(82, 75, 87),
		Warning = Color3.fromRGB(255, 193, 7),
		Error = Color3.fromRGB(255, 17, 0)
	}
	
	local TypeColor = Colors[Type] or Colors.Info
	
	local NotificationFrame = Create("Frame", NotificationContainer, {
		Size = UDim2.new(1, 0, 0, 45),
		BackgroundColor3 = Color3.fromRGB(15, 15, 15),
		BackgroundTransparency = 0,
		BorderSizePixel = 0,
		ClipsDescendants = true
	})
	
	Make("Corner", NotificationFrame, UDim.new(0, 12))
	
	local NotificationStroke = Create("UIStroke", NotificationFrame, {
		Color = Color3.fromRGB(42, 38, 43),
		Thickness = 2,
		ApplyStrokeMode = "Border"
	})
	
	local TitleLabel = Create("TextLabel", NotificationFrame, {
		Size = UDim2.new(1, -50, 0, 16), 
		Position = UDim2.new(0, 44, 0, 4),
		BackgroundTransparency = 1,
		Text = Title,
		TextColor3 = Color3.fromRGB(255, 255, 255),
		TextSize = 11,
		Font = Enum.Font.GothamBold,
		TextXAlignment = "Left",
		TextTruncate = "AtEnd"
	})
	
	local DescLabel = Create("TextLabel", NotificationFrame, {
		Size = UDim2.new(1, -50, 0, 20), 
		Position = UDim2.new(0, 44, 0, 15), 
		BackgroundTransparency = 1,
		Text = Description,
		TextColor3 = Color3.fromRGB(180, 180, 180),
		TextSize = 9,
		Font = Enum.Font.Gotham,
		TextXAlignment = "Left",
		TextWrapped = true
	})
	
	local Icon = Create("ImageLabel", NotificationFrame, {
		Name = "NotificationIcon",
		Size = UDim2.new(0, 32, 0, 32),
		Position = UDim2.new(0, 6, 0.5, -20),
		BackgroundTransparency = 1,
		Image = Image,
		ZIndex = 1000
	})
	
	local CounterLabel = Create("TextLabel", NotificationFrame, {
		Size = UDim2.new(0, 30, 0, 16),
		Position = UDim2.new(1, -35, 0, 4),
		BackgroundTransparency = 1,
		Text = tostring(Duration),
		TextColor3 = TypeColor,
		TextSize = 10,
		Font = Enum.Font.GothamBold,
		TextXAlignment = "Right"
	})
	
	local function RemoveNotification()
		CreateTween({NotificationFrame, "Position", UDim2.new(1, 50, NotificationFrame.Position.Y.Scale, 0), 0.3})
		CreateTween({NotificationFrame, "BackgroundTransparency", 1, 0.3})
		CreateTween({NotificationStroke, "Transparency", 1, 0.3, true})
		NotificationFrame:Destroy()
	end
	
	NotificationFrame.Position = UDim2.new(1, 50, 0, 0)
	CreateTween({NotificationFrame, "Position", UDim2.new(0, 0, 0, 0), 0.4})
	
	if Duration > 0 then
		local timeLeft = Duration
		local updateInterval = 0.1
		local connection
		
		connection = task.spawn(function()
			while timeLeft > 0 do
				task.wait(updateInterval)
				timeLeft = timeLeft - updateInterval
				
				if timeLeft <= 0 then
					CounterLabel.Text = "0.0"
					task.wait(0.1)
					if NotificationFrame and NotificationFrame.Parent then
						RemoveNotification()
					end
					break
				else
					CounterLabel.Text = string.format("%.1f", timeLeft)
				end
			end
		end)
	end
	
	local Notification = {}
	function Notification:Remove()
		RemoveNotification()
	end
	
	return Notification
end

function redzlib:MakeWindow(Configs)
	local WTitle = Configs[1] or Configs.Name or Configs.Title or "REDz HUB"
	local WMiniText = Configs[2] or Configs.SubTitle or "by : G H O S T"
	
	Settings.ScriptFile = Configs[3] or Configs.SaveFolder or false
	
	local function LoadFile()
		local File = Settings.ScriptFile
		if type(File) ~= "string" then return end
		if not readfile or not isfile then return end
		local s, r = pcall(isfile, File)
		
		if s and r then
			local s, _Flags = pcall(readfile, File)
			
			if s and type(_Flags) == "string" then
				local s,r = pcall(function() return HttpService:JSONDecode(_Flags) end)
				Flags = s and r or {}
			end
		end
	end;LoadFile()
	
	local UISizeX, UISizeY = unpack(redzlib.Save.UISize)
	local MainFrame = InsertTheme(Create("ImageButton", ScreenGui, {
		Size = UDim2.fromOffset(UISizeX, UISizeY),
		Position = UDim2.new(0.5, -UISizeX/2, 0.5, -UISizeY/2),
		BackgroundTransparency = 0.15,
		Name = "Hub"
}), "Main")
	Make("Gradient", MainFrame, {
		Rotation = 45
	})MakeDrag(MainFrame)
	local MainCorner = Make("Corner", MainFrame)
	local Components = Create("Folder", MainFrame, {
		Name = "Components"
	})
	
	local DropdownHolder = Create("Folder", ScreenGui, {
		Name = "Dropdown"
	})
	
	local TopBar = Create("Frame", Components, {
		Size = UDim2.new(1, 0, 0, 28),
		BackgroundTransparency = 1,
		Name = "Top Bar"
	})
	
	local Title = InsertTheme(Create("TextLabel", TopBar, {
		Position = UDim2.new(0, 15, 0.5),
		AnchorPoint = Vector2.new(0, 0.5),
		AutomaticSize = "XY",
		Text = WTitle,
		TextXAlignment = "Left",
		TextSize = 12,
		TextColor3 = Theme["Color Text"],
		BackgroundTransparency = 1,
		Font = Enum.Font.FredokaOne,  --GothamMedium
		Name = "Title"
	}, {
		InsertTheme(Create("TextLabel", {
			Size = UDim2.fromScale(0, 1),
			AutomaticSize = "X",
			AnchorPoint = Vector2.new(0, 1),
			Position = UDim2.new(1, 5, 0.9),
			Text = WMiniText,
			TextColor3 = Theme["Color Dark Greem"],
			BackgroundTransparency = 1,
			TextXAlignment = "Left",
			TextYAlignment = "Bottom",
			TextSize = 9,
			Font = Enum.Font.Gotham,
			Name = "SubTitle"
		}), "DarkText")
	}), "Text")
	
	local MainScroll = InsertTheme(Create("ScrollingFrame", Components, {
		Size = UDim2.new(0, redzlib.Save.TabSize, 1, -TopBar.Size.Y.Offset),
		ScrollBarImageColor3 = Theme["Color Theme"],
		Position = UDim2.new(0, 0, 1, 0),
		AnchorPoint = Vector2.new(0, 1),
		ScrollBarThickness = 1.5,
		BackgroundTransparency = 1,
		ScrollBarImageTransparency = 0.2,
		CanvasSize = UDim2.new(),
		AutomaticCanvasSize = "Y",
		ScrollingDirection = "Y",
		BorderSizePixel = 0,
		Name = "Tab Scroll"
	}, {
		Create("UIPadding", {
			PaddingLeft = UDim.new(0, 10),
			PaddingRight = UDim.new(0, 10),
			PaddingTop = UDim.new(0, 10),
			PaddingBottom = UDim.new(0, 10)
		}), Create("UIListLayout", {
			Padding = UDim.new(0, 5)
		})
	}), "ScrollBar")
	
	local Containers = Create("Frame", Components, {
		Size = UDim2.new(1, -MainScroll.Size.X.Offset, 1, -TopBar.Size.Y.Offset),
		AnchorPoint = Vector2.new(1, 1),
		Position = UDim2.new(1, 0, 1, 0),
		BackgroundTransparency = 1,
		ClipsDescendants = true,
		Name = "Containers"
	})

	local ParticleContainer = Create("Frame", Containers, {
		Size = UDim2.new(1, 0, 1, 0),
		BackgroundTransparency = 1,
		Name = "ThemeParticles",
		ZIndex = -5,
		ClipsDescendants = true
	})
	
	local ParticleConfig = {
		MaxParticles = 30,
		SpawnRate = 0.1,
		ParticleSize = {Min = 6, Max = 10},
		ParticleSpeed = {Min = 15, Max = 25},
		ParticleLifetime = 6
	}

local ActiveParticles = {}
local LastSpawn = 0

local function CreateCyberpunkParticle()
	if #ActiveParticles >= ParticleConfig.MaxParticles then return end
	
	local containerSize = ParticleContainer.AbsoluteSize
	local startX = math.random(10, containerSize.X - 10)
	local startY = containerSize.Y + 20
	
	local size = math.random(ParticleConfig.ParticleSize.Min, ParticleConfig.ParticleSize.Max)
	local speed = math.random(ParticleConfig.ParticleSpeed.Min, ParticleConfig.ParticleSpeed.Max)
	
	local particleColor = Theme["Color Theme"]
	
	local Particle = Create("Frame", ParticleContainer, {
		Size = UDim2.fromOffset(size, size),
		Position = UDim2.fromOffset(startX, startY),
		BackgroundColor3 = particleColor,
		BackgroundTransparency = 0.2,
		BorderSizePixel = 0
	})
	
	Create("UICorner", Particle, {
		CornerRadius = UDim.new(0.5, 0)
	})
	
	local Glow = Create("Frame", Particle, {
		Size = UDim2.new(1, 6, 1, 6),
		Position = UDim2.new(0.5, 0, 0.5, 0),
		AnchorPoint = Vector2.new(0.5, 0.5),
		BackgroundColor3 = particleColor,
		BackgroundTransparency = 0.7,
		ZIndex = -1
	})
	
	Create("UICorner", Glow, {
		CornerRadius = UDim.new(0.5, 0)
	})
	
	local ParticleData = {
		Frame = Particle,
		Glow = Glow,
		StartTime = tick(),
		Speed = speed,
		Direction = Vector2.new(0, -speed),
		OriginalColor = particleColor
	}
	
	Particle.BackgroundTransparency = 1
	Glow.BackgroundTransparency = 1
	CreateTween({Particle, "BackgroundTransparency", 0.2, 0.8})
	CreateTween({Glow, "BackgroundTransparency", 0.7, 0.8})
	
	table.insert(ActiveParticles, ParticleData)
end

local function UpdateCyberpunkParticles()
	local containerSize = ParticleContainer.AbsoluteSize
	
	for i = #ActiveParticles, 1, -1 do
		local particle = ActiveParticles[i]
		local elapsed = tick() - particle.StartTime
		if elapsed >= ParticleConfig.ParticleLifetime or 
		   particle.Frame.Position.Y.Offset < -20 then

			CreateTween({particle.Frame, "BackgroundTransparency", 1, 0.5})
			CreateTween({particle.Glow, "BackgroundTransparency", 1, 0.5})
			
			task.spawn(function()
				task.wait(0.5)
				if particle.Frame and particle.Frame.Parent then
					particle.Frame:Destroy()
				end
			end)
			
			table.remove(ActiveParticles, i)
		else
			local currentPos = particle.Frame.Position
			local newY = currentPos.Y.Offset + particle.Direction.Y * 0.016
			
			particle.Frame.Position = UDim2.fromOffset(currentPos.X.Offset, newY)
			local lifeRatio = elapsed / ParticleConfig.ParticleLifetime
			if lifeRatio > 0.8 then
				local fadeAlpha = 0.2 * (1 - ((lifeRatio - 0.8) / 0.2))
				particle.Frame.BackgroundTransparency = math.max(1 - fadeAlpha, 0.95)
			end
		end
	end
end

local function SpawnCyberpunkSystem()
	if tick() - LastSpawn >= ParticleConfig.SpawnRate and MainFrame.Visible then
		CreateCyberpunkParticle()
		LastSpawn = tick()
	end
end


	local ParticleConnection = RunService.Heartbeat:Connect(function()
		UpdateCyberpunkParticles()
		SpawnCyberpunkSystem()
	end)

	local ControlSize1, ControlSize2 = MakeDrag(Create("ImageButton", MainFrame, {
		Size = UDim2.new(0, 35, 0, 35),
		Position = MainFrame.Size,
		Active = true,
		AnchorPoint = Vector2.new(0.8, 0.8),
		BackgroundTransparency = 1,
		Name = "Control Hub Size"
	})), MakeDrag(Create("ImageButton", MainFrame, {
		Size = UDim2.new(0, 20, 1, -30),
		Position = UDim2.new(0, MainScroll.Size.X.Offset, 1, 0),
		AnchorPoint = Vector2.new(0.5, 1),
		Active = true,
		BackgroundTransparency = 1,
		Name = "Control Tab Size"
	}))
	
	local function ControlSize()
		local Pos1, Pos2 = ControlSize1.Position, ControlSize2.Position
		ControlSize1.Position = UDim2.fromOffset(math.clamp(Pos1.X.Offset, 430, 1000), math.clamp(Pos1.Y.Offset, 200, 500))
		ControlSize2.Position = UDim2.new(0, math.clamp(Pos2.X.Offset, 135, 250), 1, 0)
		
		MainScroll.Size = UDim2.new(0, ControlSize2.Position.X.Offset, 1, -TopBar.Size.Y.Offset)
		Containers.Size = UDim2.new(1, -MainScroll.Size.X.Offset, 1, -TopBar.Size.Y.Offset)
		MainFrame.Size = ControlSize1.Position
	end
	
	ControlSize1:GetPropertyChangedSignal("Position"):Connect(ControlSize)
	ControlSize2:GetPropertyChangedSignal("Position"):Connect(ControlSize)
	
	ConnectSave(ControlSize1, function()
		if not Minimized then
			redzlib.Save.UISize = {MainFrame.Size.X.Offset, MainFrame.Size.Y.Offset}
			SaveJson("redz library V5.json", redzlib.Save)
		end
	end)
	
	ConnectSave(ControlSize2, function()
		redzlib.Save.TabSize = MainScroll.Size.X.Offset
		SaveJson("redz library V5.json", redzlib.Save)
	end)
	
	local ButtonsFolder = Create("Folder", TopBar, {
		Name = "Buttons"
	})
	
	local CloseButton = Create("ImageButton", {
		Size = UDim2.new(0, 14, 0, 14),
		Position = UDim2.new(1, -10, 0.5),
		AnchorPoint = Vector2.new(1, 0.5),
		BackgroundTransparency = 1,
		Image = "rbxassetid://10747384394",
		AutoButtonColor = false,
		Name = "Close"
	})
	
	local MinimizeButton = SetProps(CloseButton:Clone(), {
		Position = UDim2.new(1, -35, 0.5),
		Image = "rbxassetid://10734896206",
		Name = "Minimize"
	})
	
	SetChildren(ButtonsFolder, {
		CloseButton,
		MinimizeButton
	})
	
	local Minimized, SaveSize, WaitClick
	local Window, FirstTab = {}, false
	function Window:CloseBtn()
		local Dialog = Window:Dialog({
			Title = "Close",
			Text = "Deseja realmente fechar o  REDz Hub? Ele contém recursos essenciais e fechar agora pode interromper funções importantes, causar falhas ou perder suas configurações. Cuidado antes de prosseguir!",
			Options = {
				{"Confirm", function()
					ScreenGui:Destroy()
				end},
				{"Cancel"}
			}
		})
	end
	function Window:MinimizeBtn()
		if WaitClick then return end
		WaitClick = true
		
		if Minimized then
			MinimizeButton.Image = "rbxassetid://10734896206"
			CreateTween({MainFrame, "Size", SaveSize, 0.25, true})
			ControlSize1.Visible = true
			ControlSize2.Visible = true
			for _, particle in pairs(ActiveParticles) do
				if particle.Frame and particle.Frame.Parent then
					particle.Frame.Visible = true
				end
			end
			Minimized = false
		else
			MinimizeButton.Image = "rbxassetid://10734924532"
			SaveSize = MainFrame.Size
			ControlSize1.Visible = false
			ControlSize2.Visible = false
			for _, particle in pairs(ActiveParticles) do
				if particle.Frame and particle.Frame.Parent then
					particle.Frame.Visible = false
				end
			end
			CreateTween({MainFrame, "Size", UDim2.fromOffset(MainFrame.Size.X.Offset, 28), 0.25, true})
			Minimized = true
		end
		
		WaitClick = false
	end
	function Window:Minimize()
		MainFrame.Visible = not MainFrame.Visible
	end
	
	function Window:SetThemeParticles(enabled)
		if enabled then
			if not ParticleConnection then
				ParticleConnection = RunService.Heartbeat:Connect(function()
					UpdateParticles()
					SpawnSystem()
				end)
			end
			ParticleContainer.Visible = true
		else
			if ParticleConnection then
				ParticleConnection:Disconnect()
				ParticleConnection = nil
			end
			ParticleContainer.Visible = false
		end
	end


	function Window:Minimize()
		MainFrame.Visible = not MainFrame.Visible
	end
function Window:AddMinimizeButton(Configs)
	local Button = MakeDrag(Create("ImageButton", ScreenGui, {
		Size = UDim2.fromOffset(60, 60),
		Position = UDim2.fromScale(0.15, 0.15),
		BackgroundTransparency = 1,
		AutoButtonColor = false
	}))

	local Stroke, Corner

	if Configs.Corner then
		Corner = Make("Corner", Button)
		SetProps(Corner, Configs.Corner)
	end

	if Configs.Stroke then
		Stroke = Make("Stroke", Button)
		SetProps(Stroke, Configs.Stroke)
	end

	SetProps(Button, Configs.Button)

	Button.Activated:Connect(Window.Minimize)

	return {
		Stroke = Stroke,
		Corner = Corner,
		Button = Button
	}
end
	function Window:Set(Val1, Val2)
		if type(Val1) == "string" and type(Val2) == "string" then
			Title.Text = Val1
			Title.SubTitle.Text = Val2
		elseif type(Val1) == "string" then
			Title.Text = Val1
		end
	end
	function Window:Dialog(Configs)
		if MainFrame:FindFirstChild("Dialog") then return end
		if Minimized then
			Window:MinimizeBtn()
		end
		
		local DTitle = Configs[1] or Configs.Title or "Dialog"
		local DText = Configs[2] or Configs.Text or "This is a Dialog"
		local DOptions = Configs[3] or Configs.Options or {}
		
		local Frame = Create("Frame", {
			Active = true,
			Size = UDim2.fromOffset(250 * 1.08, 150 * 1.08),
			Position = UDim2.fromScale(0.5, 0.5),
			AnchorPoint = Vector2.new(0.5, 0.5)
		}, {
			InsertTheme(Create("TextLabel", {
				Font = Enum.Font.GothamBold,
				Size = UDim2.new(1, 0, 0, 20),
				Text = DTitle,
				TextXAlignment = "Left",
				TextColor3 = Theme["Color Text"],
				TextSize = 15,
				Position = UDim2.fromOffset(15, 5),
				BackgroundTransparency = 1
			}), "Text"),
			InsertTheme(Create("TextLabel", {
				Font = Enum.Font.GothamMedium,
				Size = UDim2.new(1, -25),
				AutomaticSize = "Y",
				Text = DText,
				TextXAlignment = "Left",
				TextColor3 = Theme["Color Dark Text"],
				TextSize = 12,
				Position = UDim2.fromOffset(15, 25),
				BackgroundTransparency = 1,
				TextWrapped = true
			}), "DarkText")
		})Make("Gradient", Frame, {Rotation = 270})Make("Corner", Frame)
		
		local ButtonsHolder = Create("Frame", Frame, {
			Size = UDim2.fromScale(1, 0.35),
			Position = UDim2.fromScale(0, 1),
			AnchorPoint = Vector2.new(0, 1),
			BackgroundColor3 = Theme["Color Hub 2"],
			BackgroundTransparency = 1
		}, {
			Create("UIListLayout", {
				Padding = UDim.new(0, 10),
				VerticalAlignment = "Center",
				FillDirection = "Horizontal",
				HorizontalAlignment = "Center"
			})
		})
		
		local Screen = InsertTheme(Create("Frame", MainFrame, {
			BackgroundTransparency = 0.6,
			Active = true,
			BackgroundColor3 = Theme["Color Hub 2"],
			Size = UDim2.new(1, 0, 1, 0),
			BackgroundColor3 = Theme["Color Stroke"],
			Name = "Dialog"
		}), "Stroke")
		
		MainCorner:Clone().Parent = Screen
		Frame.Parent = Screen
		CreateTween({Frame, "Size", UDim2.fromOffset(250, 150), 0.2})
		CreateTween({Frame, "Transparency", 0, 0.15})
		CreateTween({Screen, "Transparency", 0.3, 0.15})
		
		local ButtonCount, Dialog = 1, {}
		function Dialog:Button(Configs)
			local Name = Configs[1] or Configs.Name or Configs.Title or ""
			local Callback = Configs[2] or Configs.Callback or function()end
			
			ButtonCount = ButtonCount + 1
			local Button = Make("Button", ButtonsHolder)
			Make("Corner", Button)
			SetProps(Button, {
				Text = Name,
				Font = Enum.Font.GothamBold,
				TextColor3 = Theme["Color Text"],
				TextSize = 12
			})
			
			for _,Button in pairs(ButtonsHolder:GetChildren()) do
				if Button:IsA("TextButton") then
					Button.Size = UDim2.new(1 / ButtonCount, -(((ButtonCount - 1) * 20) / ButtonCount), 0, 32)
				end
			end
			Button.Activated:Connect(Dialog.Close)
			Button.Activated:Connect(Callback)
		end
		function Dialog:Close()
			CreateTween({Frame, "Size", UDim2.fromOffset(250 * 1.08, 150 * 1.08), 0.2})
			CreateTween({Screen, "Transparency", 1, 0.15})
			CreateTween({Frame, "Transparency", 1, 0.15, true})
			Screen:Destroy()
		end
		table.foreach(DOptions, function(_,Button)
			Dialog:Button(Button)
		end)
		return Dialog
	end
	function Window:SelectTab(TabSelect)
		if type(TabSelect) == "number" then
			redzlib.Tabs[TabSelect].func:Enable()
		else
			for _,Tab in pairs(redzlib.Tabs) do
				if Tab.Cont == TabSelect.Cont then
					Tab.func:Enable()
				end
			end
		end
	end
	
	local ContainerList = {}
	function Window:MakeTab(paste, Configs)
		if type(paste) == "table" then Configs = paste end
		local TName = Configs[1] or Configs.Title or "Tab!"
		local TIcon = Configs[2] or Configs.Icon or ""
		
		TIcon = redzlib:GetIcon(TIcon)
		if not TIcon:find("rbxassetid://") or TIcon:gsub("rbxassetid://", ""):len() < 6 then
			TIcon = false
		end
		
		local TabSelect = Make("Button", MainScroll, {
			Size = UDim2.new(1, 0, 0, 24)
		})Make("Corner", TabSelect)
		
		local LabelTitle = InsertTheme(Create("TextLabel", TabSelect, {
			Size = UDim2.new(1, TIcon and -25 or -15, 1),
			Position = UDim2.fromOffset(TIcon and 25 or 15),
			BackgroundTransparency = 1,
			Font = Enum.Font.BuilderSansBold, --GothamMedium
			Text = TName,
			TextColor3 = Theme["Color Text"],
			TextSize = 10,
			TextXAlignment = Enum.TextXAlignment.Left,
			TextTransparency = (FirstTab and 0.3) or 0,
			TextTruncate = "AtEnd"
		}), "Text")
		
		local LabelIcon = InsertTheme(Create("ImageLabel", TabSelect, {
			Position = UDim2.new(0, 8, 0.5),
			Size = UDim2.new(0, 13, 0, 13),
			AnchorPoint = Vector2.new(0, 0.5),
			Image = TIcon or "",
			BackgroundTransparency = 1,
			ImageTransparency = (FirstTab and 0.3) or 0
		}), "Text")
		
		local Selected = InsertTheme(Create("Frame", TabSelect, {
			Size = FirstTab and UDim2.new(0, 4, 0, 4) or UDim2.new(0, 4, 0, 13),
			Position = UDim2.new(0, 1, 0.5),
			AnchorPoint = Vector2.new(0, 0.5),
			BackgroundColor3 = Theme["Color Theme"],
			BackgroundTransparency = FirstTab and 1 or 0
		}), "Theme")Make("Corner", Selected, UDim.new(0.5, 0))
		
		local Container = InsertTheme(Create("ScrollingFrame", {
			Size = UDim2.new(1, 0, 1, 0),
			Position = UDim2.new(0, 0, 1),
			AnchorPoint = Vector2.new(0, 1),
			ScrollBarThickness = 1.5,
			BackgroundTransparency = 1,
			ScrollBarImageTransparency = 0.2,
			ScrollBarImageColor3 = Theme["Color Theme"],
			AutomaticCanvasSize = "Y",
			ScrollingDirection = "Y",
			BorderSizePixel = 0,
			CanvasSize = UDim2.new(),
			Name = ("Container %i [ %s ]"):format(#ContainerList + 1, TName)
		}, {
			Create("UIPadding", {
				PaddingLeft = UDim.new(0, 10),
				PaddingRight = UDim.new(0, 10),
				PaddingTop = UDim.new(0, 10),
				PaddingBottom = UDim.new(0, 10)
			}), Create("UIListLayout", {
				Padding = UDim.new(0, 5)
			})
		}), "ScrollBar")
		
		table.insert(ContainerList, Container)
		
		if not FirstTab then Container.Parent = Containers end
		
		local function Tabs()
			if Container.Parent then return end
			for _,Frame in pairs(ContainerList) do
				if Frame:IsA("ScrollingFrame") and Frame ~= Container then
					Frame.Parent = nil
				end
			end
			Container.Parent = Containers
			Container.Size = UDim2.new(1, 0, 1, 150)
			table.foreach(redzlib.Tabs, function(_,Tab)
				if Tab.Cont ~= Container then
					Tab.func:Disable()
				end
			end)
			CreateTween({Container, "Size", UDim2.new(1, 0, 1, 0), 0.3})
			CreateTween({LabelTitle, "TextTransparency", 0, 0.35})
			CreateTween({LabelIcon, "ImageTransparency", 0, 0.35})
			CreateTween({Selected, "Size", UDim2.new(0, 4, 0, 13), 0.35})
			CreateTween({Selected, "BackgroundTransparency", 0, 0.35})
		end
		TabSelect.Activated:Connect(Tabs)
		
		FirstTab = true
		local Tab = {}
		table.insert(redzlib.Tabs, {TabInfo = {Name = TName, Icon = TIcon}, func = Tab, Cont = Container})
		Tab.Cont = Container
		
		function  Tab:Disable()
			Container.Parent = nil
			CreateTween({LabelTitle, "TextTransparency", 0.3, 0.35})
			CreateTween({LabelIcon, "ImageTransparency", 0.3, 0.35})
			CreateTween({Selected, "Size", UDim2.new(0, 4, 0, 4), 0.35})
			CreateTween({Selected, "BackgroundTransparency", 1, 0.35})
		end
		function Tab:Enable()
			Tabs()
		end
		function Tab:Visible(Bool)
			Funcs:ToggleVisible(TabSelect, Bool)
			Funcs:ToggleParent(Container, Bool, Containers)
		end
		function Tab:Destroy() TabSelect:Destroy() Container:Destroy() end
		
		function Tab:AddSection(Configs)
			local SectionName = type(Configs) == "string" and Configs or Configs[1] or Configs.Name or Configs.Title or Configs.Section
			
			local SectionFrame = Create("Frame", Container, {
				Size = UDim2.new(1, 0, 0, 20),
				BackgroundTransparency = 1,
				Name = "Option"
			})
			
			local SectionLabel = InsertTheme(Create("TextLabel", SectionFrame, {
				Font = Enum.Font.BuilderSansExtraBold,--GothamBold
				Text = SectionName,
				TextColor3 = Theme["Color Dark Purple"],
				Size = UDim2.new(1, -25, 1, 0),
				Position = UDim2.new(0, 30),
				BackgroundTransparency = 1,
				TextTruncate = "AtEnd",
				TextSize = 11,
				TextXAlignment = "Left"
			}), "Text")
			
			local Section = {}
			table.insert(redzlib.Options, {type = "Section", Name = SectionName, func = Section})
			function Section:Visible(Bool)
				if Bool == nil then SectionFrame.Visible = not SectionFrame.Visible return end
				SectionFrame.Visible = Bool
			end
			function Section:Destroy()
				SectionFrame:Destroy()
			end
			function Section:Set(New)
				if New then
					SectionLabel.Text = GetStr(New)
				end
			end
			return Section
		end
		function Tab:AddParagraph(Configs)
			local PName = Configs[1] or Configs.Title or "Paragraph"
			local PDesc = Configs[2] or Configs.Text or ""
			
			local Frame, LabelFunc = ButtonFrame(Container, PName, PDesc, UDim2.new(1, -20))
			
			local Paragraph = {}
			function Paragraph:Visible(...) Funcs:ToggleVisible(Frame, ...) end
			function Paragraph:Destroy() Frame:Destroy() end
			function Paragraph:SetTitle(Val)
				LabelFunc:SetTitle(GetStr(Val))
			end
			function Paragraph:SetDesc(Val)
				LabelFunc:SetDesc(GetStr(Val))
			end
			function Paragraph:Set(Val1, Val2)
				if Val1 and Val2 then
					LabelFunc:SetTitle(GetStr(Val1))
					LabelFunc:SetDesc(GetStr(Val2))
				elseif Val1 then
					LabelFunc:SetDesc(GetStr(Val1))
				end
			end
			return Paragraph
		end
		function Tab:AddButton(Configs)
			local BName = Configs[1] or Configs.Name or Configs.Title or "Button!"
			local BDescription = Configs.Desc or Configs.Description or ""
			local Callback = Funcs:GetCallback(Configs, 2)
			
			local FButton, LabelFunc = ButtonFrame(Container, BName, BDescription, UDim2.new(1, -20))
--Font 
			local ButtonIcon = Create("ImageLabel", FButton, {
				Size = UDim2.new(0, 14, 0, 14),
				Position = UDim2.new(1, -10, 0.5),
				AnchorPoint = Vector2.new(1, 0.5),
				BackgroundTransparency = 1,
				Image = "rbxassetid://132458316414144"
			})
			
			FButton.Activated:Connect(function()
				Funcs:FireCallback(Callback)
			end)
			
			local Button = {}
			function Button:Visible(...) Funcs:ToggleVisible(FButton, ...) end
			function Button:Destroy() FButton:Destroy() end
			function Button:Callback(...) Funcs:InsertCallback(Callback, ...) end
			function Button:Set(Val1, Val2)
				if type(Val1) == "string" and type(Val2) == "string" then
					LabelFunc:SetTitle(Val1)
					LabelFunc:SetDesc(Val2)
				elseif type(Val1) == "string" then
					LabelFunc:SetTitle(Val1)
				elseif type(Val1) == "function" then
					Callback = Val1
				end
			end
			return Button
		end
		function Tab:AddToggle(Configs)
			local TName = Configs[1] or Configs.Name or Configs.Title or "Toggle"
			local TDesc = Configs.Desc or Configs.Description or ""
			local Callback = Funcs:GetCallback(Configs, 3)
			local Flag = Configs[4] or Configs.Flag or false
			local Default = Configs[2] or Configs.Default or false
			if CheckFlag(Flag) then Default = GetFlag(Flag) end
			
			local Button, LabelFunc = ButtonFrame(Container, TName, TDesc, UDim2.new(1, -38))
			
			local ToggleHolder = InsertTheme(Create("Frame", Button, {
				Size = UDim2.new(0, 35, 0, 18),
				Position = UDim2.new(1, -10, 0.5),
				AnchorPoint = Vector2.new(1, 0.5),
				BackgroundColor3 = Theme["Color Stroke"]
			}), "Stroke")Make("Corner", ToggleHolder, UDim.new(0.5, 0))
			
			local Slider = Create("Frame", ToggleHolder, {
				BackgroundTransparency = 1,
				Size = UDim2.new(0.8, 0, 0.8, 0),
				Position = UDim2.new(0.5, 0, 0.5, 0),
				AnchorPoint = Vector2.new(0.5, 0.5)
			})
			
			local Toggle = InsertTheme(Create("Frame", Slider, {
				Size = UDim2.new(0, 12, 0, 12),
				Position = UDim2.new(0, 0, 0.5),
				AnchorPoint = Vector2.new(0, 0.5),
				BackgroundColor3 = Theme["Color Theme"]
			}), "Theme")Make("Corner", Toggle, UDim.new(0.5, 0))
			
			local WaitClick
			local function SetToggle(Val)
				if WaitClick then return end
				
				WaitClick, Default = true, Val
				SetFlag(Flag, Default)
				Funcs:FireCallback(Callback, Default)
				if Default then
					CreateTween({Toggle, "Position", UDim2.new(1, 0, 0.5), 0.25})
					CreateTween({Toggle, "BackgroundTransparency", 0, 0.25})
					CreateTween({Toggle, "AnchorPoint", Vector2.new(1, 0.5), 0.25, Wait or false})
				else
					CreateTween({Toggle, "Position", UDim2.new(0, 0, 0.5), 0.25})
					CreateTween({Toggle, "BackgroundTransparency", 0.8, 0.25})
					CreateTween({Toggle, "AnchorPoint", Vector2.new(0, 0.5), 0.25, Wait or false})
				end
				WaitClick = false
			end;task.spawn(SetToggle, Default)
			
			Button.Activated:Connect(function()
				SetToggle(not Default)
			end)
			
			local Toggle = {}
			function Toggle:Visible(...) Funcs:ToggleVisible(Button, ...) end
			function Toggle:Destroy() Button:Destroy() end
			function Toggle:Callback(...) Funcs:InsertCallback(Callback, ...)() end
			function Toggle:Set(Val1, Val2)
				if type(Val1) == "string" and type(Val2) == "string" then
					LabelFunc:SetTitle(Val1)
					LabelFunc:SetDesc(Val2)
				elseif type(Val1) == "string" then
					LabelFunc:SetTitle(Val1, false, true)
				elseif type(Val1) == "boolean" then
					if WaitClick and Val2 then
						repeat task.wait() until not WaitClick
					end
					task.spawn(SetToggle, Val1)
				elseif type(Val1) == "function" then
					Callback = Val1
				end
			end
			return Toggle
		end
		function Tab:AddDropdown(Configs)
			local DName = Configs[1] or Configs.Name or Configs.Title or "Dropdown"
			local DDesc = Configs.Desc or Configs.Description or ""
			local DOptions = Configs[2] or Configs.Options or {}
			local OpDefault = Configs[3] or Configs.Default or {}
			local Flag = Configs[5] or Configs.Flag or false
			local DMultiSelect = Configs.MultiSelect or false
			local Callback = Funcs:GetCallback(Configs, 4)
			
			local Button, LabelFunc = ButtonFrame(Container, DName, DDesc, UDim2.new(1, -180))
			
			local SelectedFrame = InsertTheme(Create("Frame", Button, {
				Size = UDim2.new(0, 150, 0, 18),
				Position = UDim2.new(1, -10, 0.5),
				AnchorPoint = Vector2.new(1, 0.5),
				BackgroundColor3 = Theme["Color Stroke"]
			}), "Stroke")Make("Corner", SelectedFrame, UDim.new(0, 4))
			
			local ActiveLabel = InsertTheme(Create("TextLabel", SelectedFrame, {
				Size = UDim2.new(0.85, 0, 0.85, 0),
				AnchorPoint = Vector2.new(0.5, 0.5),
				Position = UDim2.new(0.5, 0, 0.5, 0),
				BackgroundTransparency = 1,
				Font = Enum.Font.GothamBold,
				TextScaled = true,
				TextColor3 = Theme["Color Text"],
				Text = "..."
			}), "Text")
			
			local Arrow = Create("ImageLabel", SelectedFrame, {
				Size = UDim2.new(0, 15, 0, 15),
				Position = UDim2.new(0, -5, 0.5),
				AnchorPoint = Vector2.new(1, 0.5),
				Image = "rbxassetid://10709791523",
				BackgroundTransparency = 1
			})
			
			local NoClickFrame = Create("TextButton", DropdownHolder, {
				Name = "AntiClick",
				Size = UDim2.new(1, 0, 1, 0),
				BackgroundTransparency = 1,
				Visible = false,
				Text = ""
			})
			
			local DropFrame = Create("Frame", NoClickFrame, {
				Size = UDim2.new(SelectedFrame.Size.X, 0, 0),
				BackgroundTransparency = 0.1,
				BackgroundColor3 = Color3.fromRGB(255, 255, 255),
				AnchorPoint = Vector2.new(0, 1),
				Name = "DropdownFrame",
				ClipsDescendants = true,
				Active = true
			})Make("Corner", DropFrame)Make("Stroke", DropFrame)Make("Gradient", DropFrame, {Rotation = 60})
			
			local ScrollFrame = InsertTheme(Create("ScrollingFrame", DropFrame, {
				ScrollBarImageColor3 = Theme["Color Theme"],
				Size = UDim2.new(1, 0, 1, 0),
				ScrollBarThickness = 1.5,
				BackgroundTransparency = 1,
				BorderSizePixel = 0,
				CanvasSize = UDim2.new(),
				ScrollingDirection = "Y",
				AutomaticCanvasSize = "Y",
				Active = true
			}, {
				Create("UIPadding", {
					PaddingLeft = UDim.new(0, 8),
					PaddingRight = UDim.new(0, 8),
					PaddingTop = UDim.new(0, 5),
					PaddingBottom = UDim.new(0, 5)
				}), Create("UIListLayout", {
					Padding = UDim.new(0, 4)
				})
			}), "ScrollBar")
			
			local ScrollSize, WaitClick = 5
			local function Disable()
				WaitClick = true
				CreateTween({Arrow, "Rotation", 0, 0.2})
				CreateTween({DropFrame, "Size", UDim2.new(0, 152, 0, 0), 0.2, true})
				CreateTween({Arrow, "ImageColor3", Color3.fromRGB(255, 255, 255), 0.2})
				Arrow.Image = "rbxassetid://10709791523"
				NoClickFrame.Visible = false
				WaitClick = false
			end
			
			local function GetFrameSize()
				return UDim2.fromOffset(152, ScrollSize)
			end
			
			local function CalculateSize()
				local Count = 0
				for _,Frame in pairs(ScrollFrame:GetChildren()) do
					if Frame:IsA("Frame") or Frame.Name == "Option" then
						Count = Count + 1
					end
				end
				ScrollSize = (math.clamp(Count, 0, 10) * 25) + 10
				if NoClickFrame.Visible then
					NoClickFrame.Visible = true
					CreateTween({DropFrame, "Size", GetFrameSize(), 0.2, true})
				end
			end
			
			local function Minimize()
				if WaitClick then return end
				WaitClick = true
				if NoClickFrame.Visible then
					Arrow.Image = "rbxassetid://10709791523"
					CreateTween({Arrow, "ImageColor3", Color3.fromRGB(255, 255, 255), 0.2})
					CreateTween({DropFrame, "Size", UDim2.new(0, 152, 0, 0), 0.2, true})
					NoClickFrame.Visible = false
				else
					NoClickFrame.Visible = true
					Arrow.Image = "rbxassetid://10709790948"
					CreateTween({Arrow, "ImageColor3", Theme["Color Theme"], 0.2})
					CreateTween({DropFrame, "Size", GetFrameSize(), 0.2, true})
				end
				WaitClick = false
			end
			
			local function CalculatePos()
				local FramePos = SelectedFrame.AbsolutePosition
				local ScreenSize = ScreenGui.AbsoluteSize
				local ClampX = math.clamp((FramePos.X / UIScale), 0, ScreenSize.X / UIScale - DropFrame.Size.X.Offset)
				local ClampY = math.clamp((FramePos.Y / UIScale) , 0, ScreenSize.Y / UIScale)
				
				local NewPos = UDim2.fromOffset(ClampX, ClampY)
				local AnchorPoint = FramePos.Y > ScreenSize.Y / 1.4 and 1 or ScrollSize > 80 and 0.5 or 0
				DropFrame.AnchorPoint = Vector2.new(0, AnchorPoint)
				CreateTween({DropFrame, "Position", NewPos, 0.1})
			end
			
			local AddNewOptions, GetOptions, AddOption, RemoveOption, Selected do
				local Default = type(OpDefault) ~= "table" and {OpDefault} or OpDefault
				local MultiSelect = DMultiSelect
				local Options = {}
				Selected = MultiSelect and {} or CheckFlag(Flag) and GetFlag(Flag) or Default[1]
				
				if MultiSelect then
					for index, Value in pairs(CheckFlag(Flag) and GetFlag(Flag) or Default) do
						if type(index) == "string" and (DOptions[index] or table.find(DOptions, index)) then
							Selected[index] = Value
						elseif DOptions[Value] then
							Selected[Value] = true
						end
					end
				end
				
				local function CallbackSelected()
					SetFlag(Flag, MultiSelect and Selected or tostring(Selected))
					Funcs:FireCallback(Callback, Selected)
				end
				
				local function UpdateLabel()
					if MultiSelect then
						local list = {}
						for index, Value in pairs(Selected) do
							if Value then
								table.insert(list, index)
							end
						end
						ActiveLabel.Text = #list > 0 and table.concat(list, ", ") or "..."
					else
						ActiveLabel.Text = tostring(Selected or "...")
					end
				end
				
				local function UpdateSelected()
					if MultiSelect then
						for _,v in pairs(Options) do
							local nodes, Stats = v.nodes, v.Stats
							CreateTween({nodes[2], "BackgroundTransparency", Stats and 0 or 0.8, 0.35})
							CreateTween({nodes[2], "Size", Stats and UDim2.fromOffset(4, 12) or UDim2.fromOffset(4, 4), 0.35})
							CreateTween({nodes[3], "TextTransparency", Stats and 0 or 0.4, 0.35})
						end
					else
						for _,v in pairs(Options) do
							local Slt = v.Value == Selected
							local nodes = v.nodes
							CreateTween({nodes[2], "BackgroundTransparency", Slt and 0 or 1, 0.35})
							CreateTween({nodes[2], "Size", Slt and UDim2.fromOffset(4, 14) or UDim2.fromOffset(4, 4), 0.35})
							CreateTween({nodes[3], "TextTransparency", Slt and 0 or 0.4, 0.35})
						end
					end
					UpdateLabel()
				end
				
				local function Select(Option)
					if MultiSelect then
						Option.Stats = not Option.Stats
						Option.LastCB = tick()
						
						Selected[Option.Name] = Option.Stats
						CallbackSelected()
					else
						Option.LastCB = tick()
						
						Selected = Option.Value
						CallbackSelected()
					end
					UpdateSelected()
				end
				
				AddOption = function(index, Value)
					local Name = tostring(type(index) == "string" and index or Value)
					
					if Options[Name] then return end
					Options[Name] = {
						index = index,
						Value = Value,
						Name = Name,
						Stats = false,
						LastCB = 0
					}
					
					if MultiSelect then
						local Stats = Selected[Name]
						Selected[Name] = Stats or false
						Options[Name].Stats = Stats
					end
					
					local Button = Make("Button", ScrollFrame, {
						Name = "Option",
						Size = UDim2.new(1, 0, 0, 21),
						Position = UDim2.new(0, 0, 0.5),
						AnchorPoint = Vector2.new(0, 0.5)
					})Make("Corner", Button, UDim.new(0, 4))
					
					local IsSelected = InsertTheme(Create("Frame", Button, {
						Position = UDim2.new(0, 1, 0.5),
						Size = UDim2.new(0, 4, 0, 4),
						BackgroundColor3 = Theme["Color Theme"],
						BackgroundTransparency = 1,
						AnchorPoint = Vector2.new(0, 0.5)
					}), "Theme")Make("Corner", IsSelected, UDim.new(0.5, 0))
					
					local OptioneName = InsertTheme(Create("TextLabel", Button, {
						Size = UDim2.new(1, 0, 1),
						Position = UDim2.new(0, 10),
						Text = Name,
						TextColor3 = Theme["Color Text"],
						Font = Enum.Font.FredokaOne, --GothamBold
						TextXAlignment = "Left",
						BackgroundTransparency = 1,
						TextTransparency = 0.4
					}), "Text")
					
					Button.Activated:Connect(function()
						Select(Options[Name])
					end)
					
					Options[Name].nodes = {Button, IsSelected, OptioneName}
				end
				
				RemoveOption = function(index, Value)
					local Name = tostring(type(index) == "string" and index or Value)
					if Options[Name] then
						if MultiSelect then Selected[Name] = nil else Selected = nil end
						Options[Name].nodes[1]:Destroy()
						table.clear(Options[Name])
						Options[Name] = nil
					end
				end
				
				GetOptions = function()
					return Options
				end
				
				AddNewOptions = function(List, Clear)
					if Clear then
						table.foreach(Options, RemoveOption)
					end
					table.foreach(List, AddOption)
					CallbackSelected()
					UpdateSelected()
				end
				
				table.foreach(DOptions, AddOption)
				CallbackSelected()
				UpdateSelected()
			end
			
			Button.Activated:Connect(Minimize)
			NoClickFrame.MouseButton1Down:Connect(Disable)
			NoClickFrame.MouseButton1Click:Connect(Disable)
			MainFrame:GetPropertyChangedSignal("Visible"):Connect(Disable)
			SelectedFrame:GetPropertyChangedSignal("AbsolutePosition"):Connect(CalculatePos)
			
			Button.Activated:Connect(CalculateSize)
			ScrollFrame.ChildAdded:Connect(CalculateSize)
			ScrollFrame.ChildRemoved:Connect(CalculateSize)
			CalculatePos()
			CalculateSize()
			
			local Dropdown = {}
			function Dropdown:Visible(...) Funcs:ToggleVisible(Button, ...) end
			function Dropdown:Destroy() Button:Destroy() end
			function Dropdown:Callback(...) Funcs:InsertCallback(Callback, ...)(Selected) end
			
			function Dropdown:Add(...)
				local NewOptions = {...}
				if type(NewOptions[1]) == "table" then
					table.foreach(Option, function(_,Name)
						AddOption(Name)
					end)
				else
					table.foreach(NewOptions, function(_,Name)
						AddOption(Name)
					end)
				end
			end
			function Dropdown:Remove(Option)
				for index, Value in pairs(GetOptions()) do
					if type(Option) == "number" and index == Option or Value.Name == "Option" then
						RemoveOption(index, Value.Value)
					end
				end
			end
			function Dropdown:Select(Option)
				if type(Option) == "string" then
					for _,Val in pairs(Options) do
						if Val.Name == Option then
							Val.Active()
						end
					end
				elseif type(Option) == "number" then
					for ind,Val in pairs(Options) do
						if ind == Option then
							Val.Active()
						end
					end
				end
			end
			function Dropdown:Set(Val1, Clear)
				if type(Val1) == "table" then
					AddNewOptions(Val1, not Clear)
				elseif type(Val1) == "function" then
					Callback = Val1
				end
			end
			return Dropdown
		end
		function Tab:AddSlider(Configs)
			local SName = Configs[1] or Configs.Name or Configs.Title or "Slider!"
			local SDesc = Configs.Desc or Configs.Description or ""
			local Min = Configs[2] or Configs.MinValue or Configs.Min or 10
			local Max = Configs[3] or Configs.MaxValue or Configs.Max or 100
			local Increase = Configs[4] or Configs.Increase or 1
			local Callback = Funcs:GetCallback(Configs, 6)
			local Flag = Configs[7] or Configs.Flag or false
			local Default = Configs[5] or Configs.Default or 25
			if CheckFlag(Flag) then Default = GetFlag(Flag) end
			Min, Max = Min / Increase, Max / Increase
			
			local Button, LabelFunc = ButtonFrame(Container, SName, SDesc, UDim2.new(1, -180))
			
			local SliderHolder = Create("TextButton", Button, {
				Size = UDim2.new(0.45, 0, 1),
				Position = UDim2.new(1),
				AnchorPoint = Vector2.new(1, 0),
				AutoButtonColor = false,
				Text = "",
				BackgroundTransparency = 1
			})
			
			local SliderBar = InsertTheme(Create("Frame", SliderHolder, {
				BackgroundColor3 = Theme["Color Stroke"],
				Size = UDim2.new(1, -20, 0, 6),
				Position = UDim2.new(0.5, 0, 0.5),
				AnchorPoint = Vector2.new(0.5, 0.5)
			}), "Stroke")Make("Corner", SliderBar)
			
			local Indicator = InsertTheme(Create("Frame", SliderBar, {
				BackgroundColor3 = Theme["Color Theme"],
				Size = UDim2.fromScale(0.3, 1),
				BorderSizePixel = 0
			}), "Theme")Make("Corner", Indicator)
			
			local SliderIcon = Create("Frame", SliderBar, {
				Size = UDim2.new(0, 6, 0, 12),
				BackgroundColor3 = Color3.fromRGB(220, 220, 220),
				Position = UDim2.fromScale(0.3, 0.5),
				AnchorPoint = Vector2.new(0.5, 0.5),
				BackgroundTransparency = 0.2
			})Make("Corner", SliderIcon)
			
			local LabelVal = InsertTheme(Create("TextLabel", SliderHolder, {
				Size = UDim2.new(0, 14, 0, 14),
				AnchorPoint = Vector2.new(1, 0.5),
				Position = UDim2.new(0, 0, 0.5),
				BackgroundTransparency = 1,
				TextColor3 = Theme["Color Text"],
				Font = Enum.Font.FredokaOne,
				TextSize = 12
			}), "Text")
			
			local UIScale = Create("UIScale", LabelVal)
			
			local BaseMousePos = Create("Frame", SliderBar, {
				Position = UDim2.new(0, 0, 0.5, 0),
				Visible = false
			})
			
			local function UpdateLabel(NewValue)
				local Number = tonumber(NewValue * Increase)
				Number = math.floor(Number * 100) / 100
				
				Default, LabelVal.Text = Number, tostring(Number)
				Funcs:FireCallback(Callback, Default)
			end
			
			local function ControlPos()
				local MousePos = Player:GetMouse()
				local APos = MousePos.X - BaseMousePos.AbsolutePosition.X
				local ConfigureDpiPos = APos / SliderBar.AbsoluteSize.X
				
				SliderIcon.Position = UDim2.new(math.clamp(ConfigureDpiPos, 0, 1), 0, 0.5, 0)
			end
			
			local function UpdateValues()
				Indicator.Size = UDim2.new(SliderIcon.Position.X.Scale, 0, 1, 0)
				local SliderPos = SliderIcon.Position.X.Scale
				local NewValue = math.floor(((SliderPos * Max) / Max) * (Max - Min) + Min)
				UpdateLabel(NewValue)
			end
			
			SliderHolder.MouseButton1Down:Connect(function()
				CreateTween({SliderIcon, "Transparency", 0, 0.3})
				Container.ScrollingEnabled = false
				while UserInputService:IsMouseButtonPressed(Enum.UserInputType.MouseButton1) do task.wait()
					ControlPos()
				end
				CreateTween({SliderIcon, "Transparency", 0.2, 0.3})
				Container.ScrollingEnabled = true
				SetFlag(Flag, Default)
			end)
			
			LabelVal:GetPropertyChangedSignal("Text"):Connect(function()
				UIScale.Scale = 0.3
				CreateTween({UIScale, "Scale", 1.2, 0.1})
				CreateTween({LabelVal, "Rotation", math.random(-1, 1) * 5, 0.15, true})
				CreateTween({UIScale, "Scale", 1, 0.2})
				CreateTween({LabelVal, "Rotation", 0, 0.1})
			end)
			
			function SetSlider(NewValue)
				if type(NewValue) ~= "number" then return end
				
				local Min, Max = Min * Increase, Max * Increase
				
				local SliderPos = (NewValue - Min) / (Max - Min)
				
				SetFlag(Flag, NewValue)
				CreateTween({ SliderIcon, "Position", UDim2.fromScale(math.clamp(SliderPos, 0, 1), 0.5), 0.3, true })
			end;SetSlider(Default)
			
			SliderIcon:GetPropertyChangedSignal("Position"):Connect(UpdateValues)UpdateValues()
			
			local Slider = {}
			function Slider:Set(NewVal1, NewVal2)
				if NewVal1 and NewVal2 then
					LabelFunc:SetTitle(NewVal1)
					LabelFunc:SetDesc(NewVal2)
				elseif type(NewVal1) == "string" then
					LabelFunc:SetTitle(NewVal1)
				elseif type(NewVal1) == "function" then
					Callback = NewVal1
				elseif type(NewVal1) == "number" then
					SetSlider(NewVal1)
				end
			end
			function Slider:Callback(...) Funcs:InsertCallback(Callback, ...)(tonumber(Default)) end
			function Slider:Visible(...) Funcs:ToggleVisible(Button, ...) end
			function Slider:Destroy() Button:Destroy() end
			return Slider
		end
		function Tab:AddTextBox(Configs)
			local TName = Configs[1] or Configs.Name or Configs.Title or "Text Box"
			local TDesc = Configs.Desc or Configs.Description or ""
			local TDefault = Configs[2] or Configs.Default or ""
			local TPlaceholderText = Configs[5] or Configs.PlaceholderText or "Input"
			local TClearText = Configs[3] or Configs.ClearText or false
			local Callback = Funcs:GetCallback(Configs, 4)
			
			if type(TDefault) ~= "string" or TDefault:gsub(" ", ""):len() < 1 then
				TDefault = false
			end
			
			local Button, LabelFunc = ButtonFrame(Container, TName, TDesc, UDim2.new(1, -38))
			
			local SelectedFrame = InsertTheme(Create("Frame", Button, {
				Size = UDim2.new(0, 150, 0, 18),
				Position = UDim2.new(1, -10, 0.5),
				AnchorPoint = Vector2.new(1, 0.5),
				BackgroundColor3 = Theme["Color Stroke"]
			}), "Stroke")Make("Corner", SelectedFrame, UDim.new(0, 4))
			
			local TextBoxInput = InsertTheme(Create("TextBox", SelectedFrame, {
				Size = UDim2.new(0.85, 0, 0.85, 0),
				AnchorPoint = Vector2.new(0.5, 0.5),
				Position = UDim2.new(0.5, 0, 0.5, 0),
				BackgroundTransparency = 1,
				Font = Enum.Font.GothamBold,
				TextScaled = true,
				TextColor3 = Theme["Color Text"],
				ClearTextOnFocus = TClearText,
				PlaceholderText = TPlaceholderText,
				Text = ""
			}), "Text")
			
			local Pencil = Create("ImageLabel", SelectedFrame, {
				Size = UDim2.new(0, 12, 0, 12),
				Position = UDim2.new(0, -5, 0.5),
				AnchorPoint = Vector2.new(1, 0.5),
				Image = "rbxassetid://15637081879",
				BackgroundTransparency = 1
			})
			
			local TextBox = {}
			local function Input()
				local Text = TextBoxInput.Text
				if Text:gsub(" ", ""):len() > 0 then
					if TextBox.OnChanging then Text = TextBox.OnChanging(Text) or Text end
					Funcs:FireCallback(Callback, Text)
					TextBoxInput.Text = Text
				end
			end
			
			TextBoxInput.FocusLost:Connect(Input)Input()
			
			TextBoxInput.FocusLost:Connect(function()
				CreateTween({Pencil, "ImageColor3", Color3.fromRGB(255, 255, 255), 0.2})
			end)
			TextBoxInput.Focused:Connect(function()
				CreateTween({Pencil, "ImageColor3", Theme["Color Theme"], 0.2})
			end)
			
			TextBox.OnChanging = false
			function TextBox:Visible(...) Funcs:ToggleVisible(Button, ...) end
			function TextBox:Destroy() Button:Destroy() end
			return TextBox
		end

        -- === NOVA FUNÇÃO ADICIONADA: TAB:ADDCHAT (COM PARSER DE CÓDIGO) === --
        function Tab:AddChat()
            -- Configurações da IA (Endpoint Gratuito - Sem API Key)
            local API_URL = "https://text.pollinations.ai/"
            local systemPrompt = "Você se chama Angel IA. Responda em Português. Quando enviar códigos, use ```lua antes e ``` depois. Use ** para negrito e # para títulos."

            -- === 1. UI CONTAINER === --
            local ChatFrame = Create("Frame", Container, {
                Name = "AngelChat",
                Size = UDim2.new(1, 0, 1, 0),
                BackgroundTransparency = 0,
                BackgroundColor3 = Color3.fromRGB(15, 15, 15), -- Fundo preto
            })
            Make("Corner", ChatFrame, UDim.new(0, 12))

            -- Scroll de Mensagens
            local ChatScroll = Instance.new("ScrollingFrame", ChatFrame)
            ChatScroll.Name = "ChatScroll"
            ChatScroll.Size = UDim2.new(1, -10, 1, -50)
            ChatScroll.Position = UDim2.new(0, 5, 0, 5)
            ChatScroll.BackgroundTransparency = 1
            ChatScroll.BorderSizePixel = 0
            ChatScroll.ScrollBarThickness = 4
            ChatScroll.ScrollBarImageColor3 = Theme["Color Theme"]
            ChatScroll.AutomaticCanvasSize = Enum.AutomaticSize.Y
            local ChatLayout = Instance.new("UIListLayout", ChatScroll)
            ChatLayout.Padding = UDim.new(0, 8)
            ChatLayout.SortOrder = Enum.SortOrder.LayoutOrder

            -- Area de Input e Botão
            local InputFrame = Create("Frame", ChatFrame, {
                Size = UDim2.new(1, -10, 0, 35),
                Position = UDim2.new(0, 5, 1, -40),
                BackgroundColor3 = Theme["Color Stroke"],
                ZIndex = 2
            })
            Make("Corner", InputFrame, UDim.new(0, 8))

            local InputBox = Create("TextBox", InputFrame, {
                Size = UDim2.new(1, -55, 1, 0),
                Position = UDim2.new(0, 10, 0, 0),
                BackgroundTransparency = 1,
                Text = "",
                PlaceholderText = "Pergunte para a Angel IA...",
                TextColor3 = Theme["Color Text"],
                PlaceholderColor3 = Color3.fromRGB(150, 150, 150),
                TextSize = 14,
                Font = Enum.Font.Gotham,
                TextXAlignment = Enum.TextXAlignment.Left,
                ClearTextOnFocus = false,
                ZIndex = 2
            })

            local SendBtn = Create("TextButton", InputFrame, {
                Size = UDim2.new(0, 40, 0, 25),
                Position = UDim2.new(1, -45, 0.5, 0),
                AnchorPoint = Vector2.new(0, 0.5),
                BackgroundColor3 = Theme["Color Theme"],
                Text = "➤",
                TextColor3 = Color3.fromRGB(255, 255, 255),
                TextSize = 18,
                Font = Enum.Font.GothamBold,
                ZIndex = 2
            })
            Make("Corner", SendBtn, UDim.new(0, 6))

            -- === 2. LÓGICA DE RENDERIZAÇÃO (PARSER) === --

            -- Formata Markdown (Títulos e Negrito)
            local function FormatMarkdown(text)
                -- Títulos (# Titulo)
                text = text:gsub("# (.-)\n", "<b><font size='22'>%1</font></b>\n")
                text = text:gsub("## (.-)\n", "<b><font size='18'>%1</font></b>\n")
                -- Negrito (**Texto**)
                text = text:gsub("%*%*(.-)%*%*", "<b>%1</b>")
                return text
            end

            -- Adiciona um segmento de texto (normal)
            local function AddTextSegment(parent, text)
                if text == "" or text == nil then return end
                local label = Instance.new("TextLabel", parent)
                label.BackgroundTransparency = 1
                label.Size = UDim2.new(1, 0, 0, 0)
                label.AutomaticSize = Enum.AutomaticSize.Y
                label.Text = text
                label.RichText = true
                label.TextColor3 = Theme["Color Text"]
                label.TextSize = 13
                label.Font = Enum.Font.Gotham
                label.TextWrapped = true
                label.TextXAlignment = Enum.TextXAlignment.Left
                label.TextYAlignment = Enum.TextYAlignment.Top
            end

            -- Adiciona um container de código (Box + Botão Copiar)
            local function AddCodeSegment(parent, code)
                if code == "" or code == nil then return end
                
                local CodeBox = Instance.new("Frame", parent)
                CodeBox.BackgroundColor3 = Color3.fromRGB(25, 25, 25)
                CodeBox.AutomaticSize = Enum.AutomaticSize.Y
                CodeBox.Size = UDim2.new(1, 0, 0, 0)
                CodeBox.BorderSizePixel = 0
                Make("Corner", CodeBox, UDim.new(0, 6))
                
                local BoxPadding = Instance.new("UIPadding", CodeBox)
                BoxPadding.PaddingTop = UDim.new(0, 8)
                BoxPadding.PaddingBottom = UDim.new(0, 8)
                BoxPadding.PaddingLeft = UDim.new(0, 8)
                BoxPadding.PaddingRight = UDim.new(0, 8)

                local CodeLabel = Instance.new("TextLabel", CodeBox)
                CodeLabel.BackgroundTransparency = 1
                CodeLabel.Size = UDim2.new(1, -70, 0, 0) -- Espaço para o botão copiar
                CodeLabel.AutomaticSize = Enum.AutomaticSize.Y
                CodeLabel.Text = code
                CodeLabel.TextColor3 = Color3.fromRGB(200, 200, 200)
                CodeLabel.Font = Enum.Font.Code
                CodeLabel.TextSize = 12
                CodeLabel.TextWrapped = true
                CodeLabel.TextXAlignment = Enum.TextXAlignment.Left
                CodeLabel.TextYAlignment = Enum.TextYAlignment.Top
                CodeLabel.TextTruncate = Enum.TextTruncate.AtEnd

                local CopyBtn = Instance.new("TextButton", CodeBox)
                CopyBtn.Size = UDim2.new(0, 60, 0, 22)
                CopyBtn.Position = UDim2.new(1, -68, 0, 8)
                CopyBtn.BackgroundColor3 = Theme["Color Theme"]
                CopyBtn.Text = "Copiar"
                CopyBtn.TextColor3 = Color3.new(1, 1, 1)
                CopyBtn.Font = Enum.Font.GothamBold
                CopyBtn.TextSize = 10
                CopyBtn.ZIndex = 3
                Make("Corner", CopyBtn, UDim.new(0, 4))

                CopyBtn.MouseButton1Click:Connect(function()
                    if setclipboard then
                        pcall(setclipboard, code)
                        CopyBtn.Text = "✅ Copiado!"
                        task.wait(1)
                        CopyBtn.Text = "Copiar"
                    end
                end)
            end

            -- Função Principal de Adicionar Mensagem (Com Parser)
            local function AddMessage(sender, content)
                local isUser = sender == "Você"
                
                local MsgContainer = Instance.new("Frame", ChatScroll)
                MsgContainer.Name = "Message"
                MsgContainer.Size = UDim2.new(1, 0, 0, 0)
                MsgContainer.BackgroundTransparency = 1
                MsgContainer.AutomaticSize = Enum.AutomaticSize.Y
                MsgContainer.LayoutOrder = #ChatScroll:GetChildren() + 1

                local HLayout = Instance.new("UIListLayout", MsgContainer)
                HLayout.FillDirection = Enum.FillDirection.Horizontal
                HLayout.Padding = UDim.new(0, 8)
                HLayout.VerticalAlignment = Enum.VerticalAlignment.Top

                -- Perfil (Foto e Nome)
                local ProfileContainer = Instance.new("Frame", MsgContainer)
                ProfileContainer.Size = UDim2.new(0, 40, 0, 0)
                ProfileContainer.AutomaticSize = Enum.AutomaticSize.Y
                ProfileContainer.BackgroundTransparency = 1
                
                local ProfileLayout = Instance.new("UIListLayout", ProfileContainer)
                ProfileLayout.Padding = UDim.new(0, 2)

                local ProfileImg = Instance.new("ImageLabel", ProfileContainer)
                ProfileImg.Size = UDim2.new(0, 35, 0, 35)
                ProfileImg.BackgroundColor3 = Theme["Color Theme"]
                Make("Corner", ProfileImg, UDim.new(0.5, 0))

                if isUser then
                    ProfileImg.Image = Players:GetUserThumbnailAsync(Players.LocalPlayer.UserId, Enum.ThumbnailType.HeadShot, Enum.ThumbnailSize.Size48x48)
                else
                    -- IA usa emoji
                    local AIIcon = Instance.new("TextLabel", ProfileImg)
                    AIIcon.Size = UDim2.new(1, 0, 1, 0)
                    AIIcon.BackgroundTransparency = 1
                    AIIcon.Text = "🤖"
                    AIIcon.TextSize = 20
                    AIIcon.ZIndex = 2
                end

                local NameTag = Instance.new("TextLabel", ProfileContainer)
                NameTag.Size = UDim2.new(1, 0, 0, 14)
                NameTag.BackgroundTransparency = 1
                NameTag.Text = isUser and Players.LocalPlayer.Name or "Angel IA"
                NameTag.TextColor3 = isUser and Color3.fromRGB(100, 200, 255) or Theme["Color Theme"]
                NameTag.TextSize = 10
                NameTag.Font = Enum.Font.GothamBold
                NameTag.TextXAlignment = Enum.TextXAlignment.Center

                -- Container do Texto (Onde ocorre a mágica do Parser)
                local TextContainer = Instance.new("Frame", MsgContainer)
                TextContainer.Size = UDim2.new(1, -50, 0, 0)
                TextContainer.AutomaticSize = Enum.AutomaticSize.Y
                TextContainer.BackgroundTransparency = 1
                
                local TextListLayout = Instance.new("UIListLayout", TextContainer)
                TextListLayout.Padding = UDim.new(0, 4)

                -- === PARSER: Separa texto de código === --
                local remainingText = content

                -- Loop para encontrar múltiplos blocos de código (se houver)
                while remainingText ~= "" do
                    -- Procura o padrão: Texto ... ```lua\nCÓDIGO\n``` ... Texto
                    local preText, codeText, postText = remainingText:match("^(.-)```lua\n(.-)```(.*)")
                    
                    if codeText then
                        -- 1. Adiciona o texto que veio antes do código (Formatado como Markdown)
                        if preText ~= "" then
                            AddTextSegment(TextContainer, FormatMarkdown(preText))
                        end
                        -- 2. Adiciona o Container de Código
                        AddCodeSegment(TextContainer, codeText)
                        -- 3. Continua o loop processando o texto depois do código
                        remainingText = postText
                    else
                        -- Não achou mais códigos, adiciona o resto como texto normal e para
                        if remainingText ~= "" then
                            AddTextSegment(TextContainer, FormatMarkdown(remainingText))
                        end
                        break
                    end
                end
            end

            -- === 3. FUNÇÃO DE REQUISIÇÃO (ASK AI) === --
            local function AskAI(msg)
                if msg == "" or msg == " " then return end
                
                AddMessage("Você", msg)
                InputBox.Text = ""
                AddMessage("Angel IA", "Digitando...")

                task.spawn(function()
                    local requestFunc = syn and syn.request or http_request or request or (http and http.request)
                    
                    if not requestFunc then
                        for _, child in pairs(ChatScroll:GetChildren()) do
                            if child:IsA("Frame") and child:FindFirstChildWhichIsA("TextLabel", true) and child:FindFirstChildWhichIsA("TextLabel", true).Text == "Digitando..." then
                                child:Destroy()
                            end
                        end
                        AddMessage("Angel IA", "❌ Executor não suporta HTTP.")
                        return
                    end

                    -- Construção da URL (Endpoint Gratuito)
                    local fullPrompt = systemPrompt .. "\nUser: " .. msg
                    local url = API_URL .. HttpService:UrlEncode(fullPrompt) .. "&seed=" .. tick()

                    local success, response = pcall(function()
                        return requestFunc({
                            Url = url,
                            Method = "GET"
                        })
                    end)

                    -- Remover "Digitando..."
                    for _, child in pairs(ChatScroll:GetChildren()) do
                        if child:IsA("Frame") and child:FindFirstChildWhichIsA("TextLabel", true) and child:FindFirstChildWhichIsA("TextLabel", true).Text == "Digitando..." then
                            child:Destroy()
                        end
                    end

                    if success and response and response.Body then
                        AddMessage("Angel IA", response.Body)
                    else
                        AddMessage("Angel IA", "❌ Erro ao conectar.")
                    end
                end)
            end

            local function send()
                AskAI(InputBox.Text)
            end

            InputBox.FocusLost:Connect(function(enter)
                if enter then send() end
            end)
            
            SendBtn.Activated:Connect(send)

            local Chat = {}
            function Chat:Destroy() ChatFrame:Destroy() end
            function Chat:Visible(bool)
                if bool == nil then ChatFrame.Visible = not ChatFrame.Visible return end
                ChatFrame.Visible = bool
            end
            return Chat
        end

function Tab:AddScriptBlox()
    -- =============================================
    -- CONFIGURAÇÕES E VARIÁVEIS
    -- =============================================
    local cachedScripts = {}          -- cache principal
    local currentScriptData = nil      -- script selecionado
    local currentPage = 1
    local hasMore = true
    local isLoading = false
    local favorites = {}               -- tabela de favoritos (carregada do arquivo)
    local history = {}                  -- histórico de execução
    local cacheTimestamp = 0
    local CACHE_DURATION = 3600         -- 1 hora em segundos
    local FAVORITES_FILE = "ScriptBlox_Favorites.json"
    local HISTORY_FILE = "ScriptBlox_History.json"

    -- =============================================
    -- CARREGAR FAVORITOS E HISTÓRICO DO DISCO
    -- =============================================
    local function loadFavorites()
        if readfile and isfile and isfile(FAVORITES_FILE) then
            local success, data = pcall(function()
                return HttpService:JSONDecode(readfile(FAVORITES_FILE))
            end)
            if success and type(data) == "table" then
                favorites = data
            end
        end
    end
    loadFavorites()

    local function saveFavorites()
        if writefile then
            local success, json = pcall(function()
                return HttpService:JSONEncode(favorites)
            end)
            if success then
                writefile(FAVORITES_FILE, json)
            end
        end
    end

    local function loadHistory()
        if readfile and isfile and isfile(HISTORY_FILE) then
            local success, data = pcall(function()
                return HttpService:JSONDecode(readfile(HISTORY_FILE))
            end)
            if success and type(data) == "table" then
                history = data
            end
        end
    end
    loadHistory()

    local function saveHistory()
        if writefile then
            local success, json = pcall(function()
                return HttpService:JSONEncode(history)
            end)
            if success then
                writefile(HISTORY_FILE, json)
            end
        end
    end

    -- =============================================
    -- UI CONTAINER PRINCIPAL
    -- =============================================
    local MainFrame = Create("Frame", Container, {
        Name = "ScriptBloxContainer",
        Size = UDim2.new(1, 0, 1, 0),
        BackgroundColor3 = Color3.fromRGB(12, 12, 16),
        BackgroundTransparency = 0
    })
    Make("Corner", MainFrame, UDim.new(0, 12))

    -- =============================================
    -- BARRA DE FERRAMENTAS (FILTROS E ORDENAÇÃO)
    -- =============================================
    local Toolbar = Create("Frame", MainFrame, {
        Size = UDim2.new(1, -20, 0, 35),
        Position = UDim2.new(0.5, 0, 0, 10),
        AnchorPoint = Vector2.new(0.5, 0),
        BackgroundTransparency = 1,
        ZIndex = 10
    })
    local ToolbarLayout = Create("UIListLayout", Toolbar, {
        FillDirection = Enum.FillDirection.Horizontal,
        HorizontalAlignment = Enum.HorizontalAlignment.Left,
        VerticalAlignment = Enum.VerticalAlignment.Center,
        Padding = UDim.new(0, 8)
    })

    -- Dropdown de ordenação
    local SortDropdown = Make("Button", Toolbar, {
        Size = UDim2.new(0, 100, 0, 30),
        Text = "Sort by",
        Font = Enum.Font.GothamBold,
        TextSize = 12,
        TextColor3 = Theme["Color Text"],
        BackgroundColor3 = Theme["Color Hub 2"]
    })
    Make("Corner", SortDropdown, UDim.new(0, 8))
    Make("Stroke", SortDropdown)

    local sortOptions = {"Title", "Date", "Popularity"}
    local currentSort = "Title"

    SortDropdown.Activated:Connect(function()
        -- Abre um menu simples (poderia ser um dropdown, mas farei um ciclo)
        local idx = table.find(sortOptions, currentSort) or 1
        idx = idx % #sortOptions + 1
        currentSort = sortOptions[idx]
        SortDropdown.Text = "Sort: " .. currentSort
        -- Reordenar a lista atual
        UpdateList(cachedScripts, false)
    end)

    -- Filtro Universal / Jogo
    local FilterUniversal = Create("Frame", Toolbar, {
        Size = UDim2.new(0, 140, 0, 30),
        BackgroundTransparency = 1
    })
    local FilterLayout = Create("UIListLayout", FilterUniversal, {
        FillDirection = Enum.FillDirection.Horizontal,
        Padding = UDim.new(0, 4),
        VerticalAlignment = Enum.VerticalAlignment.Center
    })

    local UniversalToggle = Make("Button", FilterUniversal, {
        Size = UDim2.new(0, 60, 0, 30),
        Text = "Universal",
        Font = Enum.Font.GothamBold,
        TextSize = 10,
        TextColor3 = Theme["Color Text"],
        BackgroundColor3 = Theme["Color Hub 2"]
    })
    Make("Corner", UniversalToggle, UDim.new(0, 8))
    local universalFilter = false
    UniversalToggle.Activated:Connect(function()
        universalFilter = not universalFilter
        UniversalToggle.BackgroundColor3 = universalFilter and Theme["Color Theme"] or Theme["Color Hub 2"]
        UpdateList(cachedScripts, true)
    end)

    local GameToggle = Make("Button", FilterUniversal, {
        Size = UDim2.new(0, 60, 0, 30),
        Text = "Game",
        Font = Enum.Font.GothamBold,
        TextSize = 10,
        TextColor3 = Theme["Color Text"],
        BackgroundColor3 = Theme["Color Hub 2"]
    })
    Make("Corner", GameToggle, UDim.new(0, 8))
    local gameFilter = false
    GameToggle.Activated:Connect(function()
        gameFilter = not gameFilter
        GameToggle.BackgroundColor3 = gameFilter and Theme["Color Theme"] or Theme["Color Hub 2"]
        UpdateList(cachedScripts, true)
    end)

    -- Botão de favoritos
    local FavBtn = Make("Button", Toolbar, {
        Size = UDim2.new(0, 80, 0, 30),
        Text = "★ Favorites",
        Font = Enum.Font.GothamBold,
        TextSize = 10,
        TextColor3 = Theme["Color Text"],
        BackgroundColor3 = Theme["Color Hub 2"]
    })
    Make("Corner", FavBtn, UDim.new(0, 8))
    FavBtn.Activated:Connect(function()
        -- Mostra apenas favoritos
        local favList = {}
        for _, script in ipairs(cachedScripts) do
            if favorites[script.slug or script.title] then
                table.insert(favList, script)
            end
        end
        UpdateList(favList, true)
    end)

    -- Botão de histórico
    local HistoryBtn = Make("Button", Toolbar, {
        Size = UDim2.new(0, 80, 0, 30),
        Text = "📋 History",
        Font = Enum.Font.GothamBold,
        TextSize = 10,
        TextColor3 = Theme["Color Text"],
        BackgroundColor3 = Theme["Color Hub 2"]
    })
    Make("Corner", HistoryBtn, UDim.new(0, 8))
    HistoryBtn.Activated:Connect(function()
        -- Mostra histórico (precisa ter os dados dos scripts)
        -- Como histórico guarda apenas slugs/títulos, precisamos recompor
        local histScripts = {}
        for _, slug in ipairs(history) do
            for _, s in ipairs(cachedScripts) do
                if (s.slug or s.title) == slug then
                    table.insert(histScripts, s)
                    break
                end
            end
        end
        UpdateList(histScripts, true)
    end)

    -- =============================================
    -- BARRA DE PESQUISA
    -- =============================================
    local SearchFrame = Create("Frame", MainFrame, {
        Size = UDim2.new(1, -20, 0, 40),
        Position = UDim2.new(0.5, 0, 0, 50),
        AnchorPoint = Vector2.new(0.5, 0),
        BackgroundColor3 = Color3.fromRGB(25, 25, 30),
        ZIndex = 10
    })
    Make("Corner", SearchFrame, UDim.new(0, 12))
    Make("Stroke", SearchFrame)

    local SearchIcon = Create("TextLabel", SearchFrame, {
        Size = UDim2.new(0, 30, 0, 30),
        Position = UDim2.new(0, 5, 0.5, 0),
        AnchorPoint = Vector2.new(0, 0.5),
        BackgroundTransparency = 1,
        Text = "🔍",
        TextSize = 18,
        ZIndex = 11
    })

    local SearchBox = Create("TextBox", SearchFrame, {
        Size = UDim2.new(1, -50, 1, 0),
        Position = UDim2.new(0, 40, 0, 0),
        BackgroundTransparency = 1,
        Text = "",
        PlaceholderText = "Search by game or script name...",
        PlaceholderColor3 = Color3.fromRGB(120, 120, 120),
        TextColor3 = Theme["Color Text"],
        TextSize = 14,
        Font = Enum.Font.GothamMedium,
        TextXAlignment = Enum.TextXAlignment.Left,
        ClearTextOnFocus = false,
        ZIndex = 11
    })

    -- =============================================
    -- STATUS LABEL (para feedback)
    -- =============================================
    local StatusLabel = Create("TextLabel", MainFrame, {
        Size = UDim2.new(1, 0, 0, 20),
        Position = UDim2.new(0, 0, 0, 100),
        BackgroundTransparency = 1,
        Text = "Ready",
        TextColor3 = Theme["Color Dark Text"],
        TextSize = 10,
        Font = Enum.Font.Gotham,
        TextXAlignment = Enum.TextXAlignment.Center
    })

    -- =============================================
    -- SCRIPTS LIST (SCROLLING FRAME)
    -- =============================================
    local ScriptScroll = Create("ScrollingFrame", MainFrame, {
        Name = "ScriptScroll",
        Size = UDim2.new(1, 0, 1, -140),
        Position = UDim2.new(0, 0, 0, 120),
        BackgroundTransparency = 1,
        BorderSizePixel = 0,
        ScrollBarThickness = 4,
        ScrollBarImageColor3 = Theme["Color Theme"],
        ScrollingDirection = Enum.ScrollingDirection.Y,
        AutomaticCanvasSize = Enum.AutomaticSize.Y,
        CanvasSize = UDim2.new(0, 0, 0, 0),
        ClipsDescendants = true
    })

    local ScriptLayout = Create("UIListLayout", ScriptScroll, {
        Padding = UDim.new(0, 10),
        SortOrder = Enum.SortOrder.LayoutOrder
    })

    Create("UIPadding", ScriptScroll, {
        PaddingLeft = UDim.new(0, 10),
        PaddingRight = UDim.new(0, 10),
        PaddingTop = UDim.new(0, 0),
        PaddingBottom = UDim.new(0, 10)
    })

    -- =============================================
    -- MODAL PRINCIPAL (DETALHES EXPANDIDOS)
    -- =============================================
    local ModalOverlay = Create("Frame", MainFrame, {
        Name = "ModalOverlay",
        Size = UDim2.new(1, 0, 1, 0),
        BackgroundColor3 = Color3.fromRGB(0, 0, 0),
        BackgroundTransparency = 0.6,
        ZIndex = 100,
        Visible = false,
        Active = true
    })

    local ModalFrame = Create("Frame", ModalOverlay, {
        Name = "ModalFrame",
        Size = UDim2.new(0, 500, 0, 350),
        Position = UDim2.new(0.5, 0, 0.5, 0),
        AnchorPoint = Vector2.new(0.5, 0.5),
        BackgroundColor3 = Theme["Color Hub 2"],
        ZIndex = 101
    })
    Make("Corner", ModalFrame, UDim.new(0, 12))
    Make("Stroke", ModalFrame)

    local ModalHeader = Create("Frame", ModalFrame, {
        Size = UDim2.new(1, 0, 0, 40),
        BackgroundColor3 = Theme["Color Theme"],
        ZIndex = 101,
        BorderSizePixel = 0
    })
    Make("Corner", ModalHeader, UDim.new(0, 12))

    local ModalTitle = Create("TextLabel", ModalFrame, {
        Size = UDim2.new(1, -20, 0, 40),
        Position = UDim2.new(0, 10, 0, 0),
        BackgroundTransparency = 1,
        Text = "Script Details",
        TextColor3 = Color3.new(1, 1, 1),
        Font = Enum.Font.GothamBold,
        TextSize = 16,
        TextXAlignment = Enum.TextXAlignment.Left,
        ZIndex = 103
    })

    -- Área de informações detalhadas
    local InfoFrame = Create("Frame", ModalFrame, {
        Size = UDim2.new(1, -30, 0, 150),
        Position = UDim2.new(0, 15, 0, 50),
        BackgroundTransparency = 1,
        ZIndex = 101
    })
    local InfoLayout = Create("UIListLayout", InfoFrame, {
        Padding = UDim.new(0, 4),
        SortOrder = Enum.SortOrder.LayoutOrder
    })

    local ScriptAuthor = Create("TextLabel", InfoFrame, {
        Size = UDim2.new(1, 0, 0, 20),
        BackgroundTransparency = 1,
        Text = "Author: ",
        TextColor3 = Theme["Color Dark Text"],
        Font = Enum.Font.Gotham,
        TextSize = 12,
        TextXAlignment = Enum.TextXAlignment.Left,
        ZIndex = 101
    })
    local ScriptDate = Create("TextLabel", InfoFrame, {
        Size = UDim2.new(1, 0, 0, 20),
        BackgroundTransparency = 1,
        Text = "Uploaded: ",
        TextColor3 = Theme["Color Dark Text"],
        Font = Enum.Font.Gotham,
        TextSize = 12,
        TextXAlignment = Enum.TextXAlignment.Left,
        ZIndex = 101
    })
    local ScriptDownloads = Create("TextLabel", InfoFrame, {
        Size = UDim2.new(1, 0, 0, 20),
        BackgroundTransparency = 1,
        Text = "Downloads: ",
        TextColor3 = Theme["Color Dark Text"],
        Font = Enum.Font.Gotham,
        TextSize = 12,
        TextXAlignment = Enum.TextXAlignment.Left,
        ZIndex = 101
    })
    local ScriptLikes = Create("TextLabel", InfoFrame, {
        Size = UDim2.new(1, 0, 0, 20),
        BackgroundTransparency = 1,
        Text = "Likes: ",
        TextColor3 = Theme["Color Dark Text"],
        Font = Enum.Font.Gotham,
        TextSize = 12,
        TextXAlignment = Enum.TextXAlignment.Left,
        ZIndex = 101
    })
    local ScriptVerified = Create("TextLabel", InfoFrame, {
        Size = UDim2.new(1, 0, 0, 20),
        BackgroundTransparency = 1,
        Text = "Verified: ",
        TextColor3 = Theme["Color Dark Text"],
        Font = Enum.Font.Gotham,
        TextSize = 12,
        TextXAlignment = Enum.TextXAlignment.Left,
        ZIndex = 101
    })

    -- Área de preview do código
    local PreviewLabel = Create("TextLabel", ModalFrame, {
        Size = UDim2.new(1, -30, 0, 20),
        Position = UDim2.new(0, 15, 0, 210),
        BackgroundTransparency = 1,
        Text = "Preview (first 500 chars):",
        TextColor3 = Theme["Color Text"],
        Font = Enum.Font.GothamBold,
        TextSize = 12,
        TextXAlignment = Enum.TextXAlignment.Left,
        ZIndex = 101
    })

    local PreviewScroll = Create("ScrollingFrame", ModalFrame, {
        Size = UDim2.new(1, -30, 0, 80),
        Position = UDim2.new(0, 15, 0, 235),
        BackgroundColor3 = Color3.fromRGB(20, 20, 25),
        ZIndex = 101,
        ScrollBarThickness = 4,
        ScrollBarImageColor3 = Theme["Color Theme"]
    })
    Make("Corner", PreviewScroll, UDim.new(0, 6))

    local PreviewText = Create("TextLabel", PreviewScroll, {
        Size = UDim2.new(1, -10, 0, 0),
        AutomaticSize = Enum.AutomaticSize.Y,
        BackgroundTransparency = 1,
        Text = "",
        TextColor3 = Theme["Color Text"],
        Font = Enum.Font.Code,
        TextSize = 10,
        TextXAlignment = Enum.TextXAlignment.Left,
        TextYAlignment = Enum.TextYAlignment.Top,
        ZIndex = 102,
        RichText = true
    })
    Create("UIPadding", PreviewScroll, {
        PaddingLeft = UDim.new(0, 5),
        PaddingRight = UDim.new(0, 5),
        PaddingTop = UDim.new(0, 5),
        PaddingBottom = UDim.new(0, 5)
    })

    -- Botões do modal
    local ButtonsContainer = Create("Frame", ModalFrame, {
        Size = UDim2.new(1, -30, 0, 40),
        Position = UDim2.new(0, 15, 1, -10),
        AnchorPoint = Vector2.new(0, 1),
        BackgroundTransparency = 1,
        ZIndex = 101
    })

    local ButtonsLayout = Create("UIListLayout", ButtonsContainer, {
        Padding = UDim.new(0, 8),
        FillDirection = Enum.FillDirection.Horizontal,
        HorizontalAlignment = Enum.HorizontalAlignment.Center,
        VerticalAlignment = Enum.VerticalAlignment.Center
    })

    local function CreateModalBtn(text, color, icon)
        local btn = Create("TextButton", ButtonsContainer, {
            Size = UDim2.new(0, 110, 0, 35),
            BackgroundColor3 = color,
            TextColor3 = Color3.new(1, 1, 1),
            Text = (icon or "") .. " " .. text,
            Font = Enum.Font.GothamBold,
            TextSize = 12,
            ZIndex = 102
        })
        Make("Corner", btn, UDim.new(0, 8))
        return btn
    end

    local BtnRun = CreateModalBtn("Execute", Color3.fromRGB(46, 204, 113), "▶")
    local BtnCopy = CreateModalBtn("Copy", Color3.fromRGB(52, 152, 219), "📋")
    local BtnPreview = CreateModalBtn("Preview", Color3.fromRGB(155, 89, 182), "👁")
    local BtnFavorite = CreateModalBtn("★ Fav", Color3.fromRGB(241, 196, 15), "")
    local BtnAskAI = CreateModalBtn("Ask AI", Color3.fromRGB(88, 101, 242), "🤖")
    local BtnClose = CreateModalBtn("Close", Color3.fromRGB(231, 76, 60), "✕")

    -- =============================================
    -- FUNÇÕES AUXILIARES
    -- =============================================

    -- Ordenação
    local function sortScripts(list, mode)
        if mode == "Title" then
            table.sort(list, function(a,b)
                return (a.title or "") < (b.title or "")
            end)
        elseif mode == "Date" then
            table.sort(list, function(a,b)
                return (a.createdAt or 0) > (b.createdAt or 0)
            end)
        elseif mode == "Popularity" then
            table.sort(list, function(a,b)
                return (a.downloads or 0) > (b.downloads or 0)
            end)
        end
        return list
    end

    -- Aplicar filtros
    local function applyFilters(list, searchText)
        local filtered = {}
        for _, script in ipairs(list) do
            -- Filtro de texto
            local titleMatch = string.find(string.lower(tostring(script.title or "")), searchText, 1, true)
            local gameMatch = false
            if script.game and script.game.name then
                gameMatch = string.find(string.lower(tostring(script.game.name)), searchText, 1, true)
            end
            if not titleMatch and not gameMatch and script.isUniversal then
                gameMatch = string.find("universal", searchText, 1, true)
            end
            if searchText ~= "" and not (titleMatch or gameMatch) then
                goto continue
            end

            -- Filtros de tipo
            if universalFilter and not script.isUniversal then goto continue end
            if gameFilter and script.isUniversal then goto continue end

            table.insert(filtered, script)
            ::continue::
        end
        return filtered
    end

    -- Atualizar lista (com animações)
    local function UpdateList(scripts, isSearch)
        -- Limpar scroll
        for _, child in pairs(ScriptScroll:GetChildren()) do
            if child:IsA("ImageButton") or child:IsA("TextLabel") then
                child:Destroy()
            end
        end

        -- Aplicar ordenação
        scripts = sortScripts(scripts, currentSort)

        if #scripts == 0 then
            local msg = isSearch and "No scripts match your search." or "No scripts loaded. Try refreshing."
            CreateStatusLabel(msg, false)
            return
        end

        for i, script in ipairs(scripts) do
            local card = CreateScriptCard(script)

            -- Animação de entrada (scale)
            card.Size = UDim2.new(1, 0, 0, 70)
            card.BackgroundTransparency = 1
            local scale = Instance.new("UIScale", card)
            scale.Scale = 0.8
            CreateTween({scale, "Scale", 1}, 0.2)
            CreateTween({card, "BackgroundTransparency", 0}, 0.3)
        end
    end

    -- Criar card de script (com cor variada)
    local function CreateScriptCard(scriptData)
        local cardColor = scriptData.isUniversal and Color3.fromRGB(20, 30, 40) or Color3.fromRGB(40, 20, 30)
        -- Variação baseada no título para dar diversidade
        local hue = (string.len(scriptData.title or "") % 10) / 10
        local color = Color3.fromHSV(hue, 0.3, 0.2)

        local card = Create("ImageButton", ScriptScroll, {
            Size = UDim2.new(1, 0, 0, 70),
            BackgroundColor3 = color,
            AutoButtonColor = false,
            ZIndex = 1
        })

        local cardCorner = Make("Corner", card, UDim.new(0, 10))
        local cardStroke = Make("Stroke", card)

        local GameIcon = Create("TextLabel", card, {
            Size = UDim2.new(0, 50, 0, 50),
            Position = UDim2.new(0, 10, 0.5, 0),
            AnchorPoint = Vector2.new(0, 0.5),
            BackgroundColor3 = Theme["Color Stroke"],
            Text = scriptData.isUniversal and "🌐" or "🎮",
            TextSize = 20,
            TextColor3 = Theme["Color Theme"],
            Font = Enum.Font.GothamBold,
            ZIndex = 2
        })
        Make("Corner", GameIcon, UDim.new(0.5, 0))

        local InfoContainer = Create("Frame", card, {
            Size = UDim2.new(1, -90, 1, -16),
            Position = UDim2.new(0, 70, 0, 8),
            BackgroundTransparency = 1,
            ZIndex = 2
        })
        local InfoLayout = Create("UIListLayout", InfoContainer, {
            Padding = UDim.new(0, 2)
        })

        local Title = Create("TextLabel", InfoContainer, {
            Size = UDim2.new(1, 0, 0, 20),
            BackgroundTransparency = 1,
            Text = tostring(scriptData.title or "Unknown Title"),
            TextColor3 = Theme["Color Text"],
            Font = Enum.Font.GothamBold,
            TextSize = 13,
            TextXAlignment = Enum.TextXAlignment.Left,
            TextTruncate = Enum.TextTruncate.AtEnd,
            ZIndex = 2
        })

        local GameName = Create("TextLabel", InfoContainer, {
            Size = UDim2.new(1, 0, 0, 16),
            BackgroundTransparency = 1,
            Text = scriptData.isUniversal and "Universal Script" or (scriptData.game and scriptData.game.name or "Unknown Game"),
            TextColor3 = Theme["Color Dark Text"],
            Font = Enum.Font.Gotham,
            TextSize = 11,
            TextXAlignment = Enum.TextXAlignment.Left,
            ZIndex = 2
        })

        local Verified = Create("Frame", card, {
            Size = UDim2.new(0, 24, 0, 24),
            Position = UDim2.new(1, -12, 0, 12),
            BackgroundColor3 = Color3.fromRGB(0, 0, 0, 0.5),
            ZIndex = 2
        })
        Make("Corner", Verified, UDim.new(0.5, 0))

        local VerifiedIcon = Create("TextLabel", Verified, {
            Size = UDim2.new(1, 0, 1, 0),
            BackgroundTransparency = 1,
            Text = scriptData.verified and "✔" or "",
            TextColor3 = scriptData.verified and Color3.fromRGB(85, 170, 85) or Color3.fromRGB(150, 150, 150),
            Font = Enum.Font.GothamBold,
            TextSize = 14,
            ZIndex = 3
        })
        if not scriptData.verified then Verified.Visible = false end

        -- Ícone de favorito
        local FavIcon = Create("TextLabel", card, {
            Size = UDim2.new(0, 20, 0, 20),
            Position = UDim2.new(1, -36, 0, 12),
            BackgroundTransparency = 1,
            Text = favorites[scriptData.slug or scriptData.title] and "★" or "☆",
            TextColor3 = Color3.fromRGB(255, 215, 0),
            Font = Enum.Font.GothamBold,
            TextSize = 18,
            ZIndex = 2
        })

        card.MouseButton1Click:Connect(function()
            currentScriptData = scriptData
            -- Preencher detalhes no modal
            ModalTitle.Text = scriptData.title or "Script"
            ScriptAuthor.Text = "Author: " .. (scriptData.user and scriptData.user.username or "Unknown")
            ScriptDate.Text = "Uploaded: " .. (scriptData.createdAt or "N/A")
            ScriptDownloads.Text = "Downloads: " .. (scriptData.downloads or 0)
            ScriptLikes.Text = "Likes: " .. (scriptData.likes or 0)
            ScriptVerified.Text = "Verified: " .. (scriptData.verified and "Yes" or "No")

            -- Preview (primeiras 500 chars)
            local preview = (scriptData.script or ""):sub(1, 500) .. "..."
            PreviewText.Text = preview

            ModalOverlay.Visible = true
            CreateTween({ModalFrame, "Size", UDim2.new(0, 500, 0, 350)}, 0.25)
        end)

        card.MouseEnter:Connect(function()
            CreateTween({card, "Position", UDim2.new(0, -2, 0, 0)}, 0.15)
            cardStroke.Color = Theme["Color Theme"]
        end)

        card.MouseLeave:Connect(function()
            CreateTween({card, "Position", UDim2.new(0, 0, 0, 0)}, 0.15)
            cardStroke.Color = Theme["Color Stroke"]
        end)

        return card
    end

    local function CreateStatusLabel(text, isError)
        local lbl = Create("TextLabel", ScriptScroll, {
            Size = UDim2.new(1, -20, 0, 30),
            Position = UDim2.new(0.5, 0, 0, 20),
            AnchorPoint = Vector2.new(0.5, 0),
            BackgroundTransparency = 1,
            Text = text,
            TextColor3 = isError and Color3.fromRGB(255, 80, 80) or Theme["Color Dark Text"],
            Font = Enum.Font.GothamMedium,
            TextSize = 12,
            ZIndex = 2,
            TextWrapped = true,
            TextXAlignment = Enum.TextXAlignment.Center
        })
        return lbl
    end

    -- =============================================
    -- REQUISIÇÃO À API COM CACHE E PAGINAÇÃO
    -- =============================================
    local function FetchScripts(reset)
        if isLoading then return end
        isLoading = true

        -- Verifica cache
        if reset then
            cachedScripts = {}
            currentPage = 1
            hasMore = true
        end

        if #cachedScripts > 0 and tick() - cacheTimestamp < CACHE_DURATION and not reset then
            -- Usa cache
            UpdateList(cachedScripts, false)
            isLoading = false
            return
        end

        StatusLabel.Text = "Loading page " .. currentPage .. "..."
        local loadingBar = Create("Frame", ScriptScroll, {
            Size = UDim2.new(0, 0, 0, 3),
            Position = UDim2.new(0, 10, 0, 20),
            BackgroundColor3 = Theme["Color Theme"],
            ZIndex = 2
        })
        Make("Corner", loadingBar, UDim.new(1, 0))
        CreateTween({loadingBar, "Size", UDim2.new(1, -20, 0, 3)}, 1.5)

        local HttpService = game:GetService("HttpService")
        local url = "https://scriptblox.com/api/script/fetch?page=" .. currentPage
        local success, response = pcall(function()
            return HttpService:RequestAsync({
                Url = url,
                Method = "GET",
                Headers = {
                    ["User-Agent"] = "Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/96.0.4664.110 Safari/537.36"
                }
            })
        end)

        loadingBar:Destroy()

        if success then
            if response.StatusCode == 200 then
                local data = HttpService:JSONDecode(response.Body)
                if data and data.result and data.result.scripts then
                    -- Adicionar novos scripts ao cache
                    for _, script in ipairs(data.result.scripts) do
                        table.insert(cachedScripts, script)
                    end
                    hasMore = data.result.hasNext or false
                    cacheTimestamp = tick()
                    StatusLabel.Text = "✅ Loaded " .. #cachedScripts .. " scripts"
                    StatusLabel.TextColor3 = Color3.fromRGB(46, 204, 113)
                    UpdateList(cachedScripts, false)
                    currentPage = currentPage + 1
                else
                    StatusLabel.Text = "❌ Invalid API response."
                    StatusLabel.TextColor3 = Color3.fromRGB(255, 80, 80)
                end
            else
                StatusLabel.Text = "❌ Error " .. response.StatusCode
                StatusLabel.TextColor3 = Color3.fromRGB(255, 80, 80)
            end
        else
            StatusLabel.Text = "❌ Request failed"
            StatusLabel.TextColor3 = Color3.fromRGB(255, 80, 80)
            warn("FetchScripts error:", response)
        end
        isLoading = false
    end

    -- Scroll infinito
    ScriptScroll:GetPropertyChangedSignal("CanvasPosition"):Connect(function()
        if not hasMore or isLoading then return end
        local scrollPos = ScriptScroll.CanvasPosition.Y
        local scrollMax = ScriptScroll.CanvasSize.Y.Offset - ScriptScroll.AbsoluteWindowSize.Y
        if scrollPos >= scrollMax - 100 then
            FetchScripts(false)
        end
    end)

    -- =============================================
    -- EVENTOS DOS BOTÕES DO MODAL
    -- =============================================
    BtnRun.MouseButton1Click:Connect(function()
        if currentScriptData and currentScriptData.script then
            -- Confirmação extra para scripts não verificados
            if not currentScriptData.verified then
                local confirmed = Window:Dialog({
                    Title = "⚠️ Warning",
                    Text = "This script is not verified. Executing may be unsafe. Continue?",
                    Options = {
                        {"Yes, execute", function() end},
                        {"Cancel"}
                    }
                })
                -- Nota: O dialog é assíncrono, então precisamos de uma lógica melhor.
                -- Por simplicidade, vamos executar direto (ou você pode adaptar)
                pcall(function()
                    loadstring(currentScriptData.script)()
                    -- Adicionar ao histórico
                    local slug = currentScriptData.slug or currentScriptData.title
                    if not table.find(history, slug) then
                        table.insert(history, 1, slug)
                        if #history > 50 then table.remove(history) end
                        saveHistory()
                    end
                end)
            else
                pcall(function()
                    loadstring(currentScriptData.script)()
                    local slug = currentScriptData.slug or currentScriptData.title
                    if not table.find(history, slug) then
                        table.insert(history, 1, slug)
                        if #history > 50 then table.remove(history) end
                        saveHistory()
                    end
                end)
            end
            ModalOverlay.Visible = false
        end
    end)

    BtnCopy.MouseButton1Click:Connect(function()
        if currentScriptData and currentScriptData.script then
            if setclipboard then
                setclipboard(currentScriptData.script)
                local original = BtnCopy.Text
                BtnCopy.Text = "✅ Copied!"
                task.wait(1)
                if BtnCopy and BtnCopy.Parent then
                    BtnCopy.Text = original
                end
            end
        end
    end)

    BtnPreview.MouseButton1Click:Connect(function()
        -- Já mostramos preview no modal, mas podemos expandir
        -- Talvez abrir um frame maior
    end)

    BtnFavorite.MouseButton1Click:Connect(function()
        if currentScriptData then
            local key = currentScriptData.slug or currentScriptData.title
            if favorites[key] then
                favorites[key] = nil
                BtnFavorite.Text = "★ Fav"
            else
                favorites[key] = true
                BtnFavorite.Text = "★ Faved"
            end
            saveFavorites()
        end
    end)

    BtnAskAI.MouseButton1Click:Connect(function()
        if currentScriptData then
            -- Integrar com a IA: abrir o chat com contexto
            -- Supondo que haja uma função global para abrir o chat
            if redzlib.AI and redzlib.AI.OpenChat then
                redzlib.AI.OpenChat("Sobre o script: " .. currentScriptData.title .. "\n\n" .. currentScriptData.script)
            else
                notify("IA não disponível", "Função de IA não encontrada.", 3)
            end
        end
    end)

    BtnClose.MouseButton1Click:Connect(function()
        ModalOverlay.Visible = false
        currentScriptData = nil
    end)

    -- =============================================
    -- INICIALIZAÇÃO
    -- =============================================
    task.spawn(function()
        FetchScripts(true)
    end)

    local ScriptBlox = {}
    function ScriptBlox:Destroy() MainFrame:Destroy() end
    function ScriptBlox:Visible(bool)
        if bool == nil then MainFrame.Visible = not MainFrame.Visible return end
        MainFrame.Visible = bool
    end
    return ScriptBlox
end

function Tab:AddDiscordInvite(Configs)
	local Title = Configs[1] or Configs.Name or Configs.Title or "Discord Server"
	local Description = Configs[2] or Configs.Desc or Configs.Description or ""
	local Logo = Configs[3] or Configs.Icon or Configs.Logo or ""
	local Invite = Configs[4] or Configs.Invite or Configs.Link or ""
	local MembersOnline = Configs.Online or Configs.MembersOnline or 0
	local TotalMembers = Configs.Members or Configs.TotalMembers or 0
	local BannerImage = Configs.Banner or Configs.BannerImage or ""
	
	local InviteHolder = Create("Frame", Container, {
		Size = UDim2.new(1, 0, 0, 148),
		Name = "Option",
		BackgroundTransparency = 1
	})
	
	local InviteLabel = InsertTheme(Create("TextLabel", InviteHolder, {
		Size = UDim2.new(1, 0, 0, 15),
		Position = UDim2.new(0, 5),
		TextColor3 = Color3.fromRGB(40, 150, 255),
		Font = Enum.Font.GothamBold,
		TextXAlignment = "Left",
		BackgroundTransparency = 1,
		TextSize = 9,
		Text = Invite
	}), "Text")
	
	local MainFrame = InsertTheme(Create("Frame", InviteHolder, {
		Size = UDim2.new(0, 178, 1, -15),
		Position = UDim2.new(0, 5, 1, 0),
		AnchorPoint = Vector2.new(0, 1),
		BackgroundColor3 = Theme["Color Hub 2"],
		ClipsDescendants = true
	}), "Frame")
	Make("Corner", MainFrame, UDim.new(0, 12))
	Make("Stroke", MainFrame)
	
	local BannerArea = Create("ImageLabel", MainFrame, {
		Size = UDim2.new(1, 0, 0.28, 0),
		Image = BannerImage,
		BackgroundColor3 = Color3.fromRGB(88, 101, 242),
		BackgroundTransparency = BannerImage ~= "" and 1 or 0,
		ScaleType = Enum.ScaleType.Crop
	})
	Make("Corner", BannerArea, UDim.new(0, 12))
	
	if BannerImage == "" then
		local BannerGradient = Create("UIGradient", BannerArea, {
			Rotation = -15,
			Color = ColorSequence.new({
				ColorSequenceKeypoint.new(0, Color3.fromRGB(88, 101, 242)),
				ColorSequenceKeypoint.new(1, Color3.fromRGB(120, 130, 255))
			})
		})
	end
	
	
	local ServerIcon = Create("ImageLabel", MainFrame, {
		Size = UDim2.new(0, 33, 0, 33),
		Position = UDim2.new(0, 10, 0.28, 0),
		AnchorPoint = Vector2.new(0, 0.5),
		Image = Logo,
		BackgroundTransparency = Logo == "" and 1 or 0,
		BackgroundColor3 = Theme["Color Hub 2"]
	})
	Make("Corner", ServerIcon, UDim.new(0, 8))
	if Logo ~= "" then
		Make("Stroke", ServerIcon, nil, Theme["Color Hub 2"], 2.2)
	end
	

	local ServerTitle = InsertTheme(Create("TextLabel", MainFrame, {
		Size = UDim2.new(1, -20, 0, 10),
		Position = UDim2.new(0, 10, 0.44, 0),
		TextXAlignment = "Left",
		BackgroundTransparency = 1,
		TextSize = 11,
		Text = Title,
		Font = Enum.Font.GothamBold,
		TextColor3 = Theme["Color Text"]
	}), "Text")
	
	
	local MembersFrame
	if MembersOnline > 0 or TotalMembers > 0 then
		MembersFrame = Create("Frame", MainFrame, {
			Size = UDim2.new(1, -20, 0, 9),
			Position = UDim2.new(0, 7, 0.52, 0),
			BackgroundTransparency = 1
		}, {
			Create("UIListLayout", {
				HorizontalAlignment = "Left",
				VerticalAlignment = "Center",
				FillDirection = "Horizontal",
				Padding = UDim.new(0, 4)
			}),
			Create("UIPadding", {
				PaddingLeft = UDim.new(0, 3),
				PaddingRight = UDim.new(0, 10)
			})
		})
		
		local function CreateStatusIndicator(color, text)
			local StatusFrame = Create("Frame", MembersFrame, {
				Size = UDim2.new(0, 0, 1, 0),
				AutomaticSize = "X",
				BackgroundTransparency = 1
			})
			
			local StatusDot = Create("Frame", StatusFrame, {
				Size = UDim2.new(0, 3, 0, 3),
				Position = UDim2.new(0, 5, 0.5, 0),
				AnchorPoint = Vector2.new(0, 0.5),
				BackgroundColor3 = color
			})
			Make("Corner", StatusDot, UDim.new(1, 0))
			
			local StatusText = InsertTheme(Create("TextLabel", StatusFrame, {
				Size = UDim2.new(0, 0, 1, 0),
				Position = UDim2.new(0, 12, 0.5, 0),
				AnchorPoint = Vector2.new(0, 0.5),
				AutomaticSize = "X",
				BackgroundTransparency = 1,
				TextSize = 7,
				Text = text,
				Font = Enum.Font.Gotham,
				TextColor3 = Theme["Color Dark Text"]
			}), "DarkText")
		end
		
		if MembersOnline > 0 then
			CreateStatusIndicator(Color3.fromRGB(67, 181, 129), MembersOnline .. " Online")
		end
		
		if TotalMembers > 0 then
			CreateStatusIndicator(Color3.fromRGB(86, 101, 105), TotalMembers .. " Members")
		end
	end
	

	local DescriptionLabel = InsertTheme(Create("TextLabel", MainFrame, {
		Size = UDim2.new(1, -60, 0, 8),
		Position = UDim2.new(0, 10, MembersFrame and 0.6 or 0.56, 0),
		TextXAlignment = "Left",
		AutomaticSize = "Y",
		BackgroundTransparency = 1,
		TextSize = 8,
		Text = Description,
		TextWrapped = true,
		Font = Enum.Font.Gotham,
		TextColor3 = Theme["Color Dark Text"]
	}), "DarkText")
	

	local BottomSection = InsertTheme(Create("Frame", MainFrame, {
		Size = UDim2.new(1, 0, Description == "" and 0.28 or 0.42, 0),
		Position = UDim2.new(0, 0, 1, 0),
		AnchorPoint = Vector2.new(0, 1),
		BackgroundColor3 = Theme["Color Hub 2"],
		BorderSizePixel = 0
	}), "Frame")
	
	if Description ~= "" then
		local BottomGradient = Create("UIGradient", BottomSection, {
			Rotation = -90,
			Transparency = NumberSequence.new({
				NumberSequenceKeypoint.new(0.00, 0.00),
				NumberSequenceKeypoint.new(0.60, 0.00),
				NumberSequenceKeypoint.new(1.00, 1.00)
			})
		})
	end
	

	local JoinButton = InsertTheme(Create("TextButton", BottomSection, {
		Position = UDim2.new(0.5, 0, 1, -9),
		Size = UDim2.new(1, -18, 0, 18),
		AnchorPoint = Vector2.new(0.5, 1),
		Text = "Join Server",
		Font = Enum.Font.GothamBold,
		TextSize = 10,
		BackgroundColor3 = Color3.fromRGB(67, 181, 129),
		TextColor3 = Theme["Color Text"]
	}), "Text")
	Make("Corner", JoinButton, UDim.new(0.5, 0))
	
	local clickCooldown = 0
	JoinButton.Activated:Connect(function()
		if tick() - clickCooldown < 5 then return end
		clickCooldown = tick()
		
		local originalText = JoinButton.Text
		JoinButton.Text = "Copied to Clipboard!"
		
		if setclipboard then
			setclipboard(Invite)
		end
		
		task.wait(4)
		if JoinButton and JoinButton.Parent then
			JoinButton.Text = originalText
		end
	end)
	
	local DiscordInvite = {}
	function DiscordInvite:Destroy() 
		InviteHolder:Destroy() 
	end
	function DiscordInvite:Visible(...) 
		Funcs:ToggleVisible(InviteHolder, ...) 
	end
	function DiscordInvite:Set(newTitle, newDesc, newInvite)
		if newTitle then
			ServerTitle.Text = newTitle
		end
		if newDesc then
			DescriptionLabel.Text = newDesc
		end
		if newInvite then
			InviteLabel.Text = newInvite
		end
	end
	
	return DiscordInvite
end
		--[[function Tab:AddDiscordInvite(Configs)
			local Title = Configs[1] or Configs.Name or Configs.Title or "Discord"
			local Desc = Configs.Desc or Configs.Description or ""
			local Logo = Configs[2] or Configs.Logo or ""
			local Invite = Configs[3] or Configs.Invite or ""
			
			local InviteHolder = Create("Frame", Container, {
				Size = UDim2.new(1, 0, 0, 80),
				Name = "Option",
				BackgroundTransparency = 1
			})
			
			local InviteLabel = Create("TextLabel", InviteHolder, {
				Size = UDim2.new(1, 0, 0, 15),
				Position = UDim2.new(0, 5),
				TextColor3 = Color3.fromRGB(40, 150, 255),
				Font = Enum.Font.GothamBold,
				TextXAlignment = "Left",
				BackgroundTransparency = 1,
				TextSize = 10,
				Text = Invite
			})
			
			local FrameHolder = InsertTheme(Create("Frame", InviteHolder, {
				Size = UDim2.new(1, 0, 0, 65),
				AnchorPoint = Vector2.new(0, 1),
				Position = UDim2.new(0, 0, 1),
				BackgroundColor3 = Theme["Color Hub 2"]
			}), "Frame")Make("Corner", FrameHolder)
			
			local ImageLabel = Create("ImageLabel", FrameHolder, {
				Size = UDim2.new(0, 30, 0, 30),
				Position = UDim2.new(0, 7, 0, 7),
				Image = Logo,
				BackgroundTransparency = 1
			})Make("Corner", ImageLabel, UDim.new(0, 4))Make("Stroke", ImageLabel)
			
			local LTitle = InsertTheme(Create("TextLabel", FrameHolder, {
				Size = UDim2.new(1, -52, 0, 15),
				Position = UDim2.new(0, 44, 0, 7),
				Font = Enum.Font.GothamBold,
				TextColor3 = Theme["Color Text"],
				TextXAlignment = "Left",
				BackgroundTransparency = 1,
				TextSize = 10,
				Text = Title
			}), "Text")
			
			local LDesc = InsertTheme(Create("TextLabel", FrameHolder, {
				Size = UDim2.new(1, -52, 0, 0),
				Position = UDim2.new(0, 44, 0, 22),
				TextWrapped = "Y",
				AutomaticSize = "Y",
				Font = Enum.Font.Gotham,
				TextColor3 = Theme["Color Dark Text"],
				TextXAlignment = "Left",
				BackgroundTransparency = 1,
				TextSize = 8,
				Text = Desc
			}), "DarkText")
			
			local JoinButton = Create("TextButton", FrameHolder, {
				Size = UDim2.new(1, -14, 0, 16),
				AnchorPoint = Vector2.new(0.5, 1),
				Position = UDim2.new(0.5, 0, 1, -7),
				Text = "Join",
				Font = Enum.Font.GothamBold,
				TextSize = 12,
				TextColor3 = Color3.fromRGB(220, 220, 220),
				BackgroundColor3 = Color3.fromRGB(50, 150, 50)
			})Make("Corner", JoinButton, UDim.new(0, 5))
			
			local ClickDelay
			JoinButton.Activated:Connect(function()
				setclipboard(Invite)
				if ClickDelay then return end
				
				ClickDelay = true
				SetProps(JoinButton, {
					Text = "Copied to Clipboard",
					BackgroundColor3 = Color3.fromRGB(100, 100, 100),
					TextColor3 = Color3.fromRGB(150, 150, 150)
				})task.wait(5)
				SetProps(JoinButton, {
					Text = "Join",
					BackgroundColor3 = Color3.fromRGB(50, 150, 50),
					TextColor3 = Color3.fromRGB(220, 220, 220)
				})ClickDelay = false
			end)
			
			local DiscordInvite = {}
			function DiscordInvite:Destroy() InviteHolder:Destroy() end
			function DiscordInvite:Visible(...) Funcs:ToggleVisible(InviteHolder, ...) end
			return DiscordInvite
		end]] --777
		return Tab
	end
	
	CloseButton.Activated:Connect(Window.CloseBtn)
	MinimizeButton.Activated:Connect(Window.MinimizeBtn)

	return Window
end

return redzlib
